<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-0.9.333">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Henrik Kenneth Andersen">
<meta name="author" content="Jochen Mayerl">
<meta name="dcterms.date" content="2022-06-21">

<title>Rehabilitating the Lagged Dependent Variable with Structural Equation Modeling</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<script src="lagged-dv_files/libs/clipboard/clipboard.min.js"></script>
<script src="lagged-dv_files/libs/quarto-html/quarto.js"></script>
<script src="lagged-dv_files/libs/quarto-html/popper.min.js"></script>
<script src="lagged-dv_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="lagged-dv_files/libs/quarto-html/anchor.min.js"></script>
<link href="lagged-dv_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link id="quarto-text-highlighting-styles" href="lagged-dv_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet">
<script src="lagged-dv_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="lagged-dv_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="lagged-dv_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"> <span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#benefits-of-the-ldv" id="toc-benefits-of-the-ldv" class="nav-link" data-scroll-target="#benefits-of-the-ldv"> <span class="header-section-number">2</span> Benefits of the LDV</a></li>
  <li><a href="#arguments-against-the-ldv" id="toc-arguments-against-the-ldv" class="nav-link" data-scroll-target="#arguments-against-the-ldv"> <span class="header-section-number">3</span> Arguments Against the LDV</a></li>
  <li><a href="#the-structural-equation-modeling-approach" id="toc-the-structural-equation-modeling-approach" class="nav-link" data-scroll-target="#the-structural-equation-modeling-approach"> <span class="header-section-number">4</span> The Structural Equation Modeling Approach</a></li>
  <li><a href="#a-simulated-example" id="toc-a-simulated-example" class="nav-link" data-scroll-target="#a-simulated-example"> <span class="header-section-number">5</span> A Simulated Example</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"> <span class="header-section-number">6</span> Conclusion</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"> <span class="header-section-number">7</span> References</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Rehabilitating the Lagged Dependent Variable with Structural Equation Modeling</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Authors</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    Henrik Kenneth Andersen <a href="https://orcid.org/0000-0001-6842-5337" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Chemnitz University of Technology
          </p>
      </div>
      <div class="quarto-title-meta-contents">
    Jochen Mayerl <a href="https://orcid.org/0000-0002-4599-9976" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a>
  </div>
    <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Chemnitz University of Technology
          </p>
      </div>
    </div>



<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">June 21, 2022</p>
    </div>
  </div>
    
  </div>
  
<div>
  <div class="abstract">
    <div class="abstract-title">Abstract</div>
    It has been argued that including the lagged dependent variable in panel models will open up unintended back-door paths and bias the estimates of the causal variable. We show that panel analysis in the structural equation modeling framework gets around this issue. Including the lagged dependent variable has the benefit of closing back-door paths due to unobserved time-varying confounders. We demonstrate this by looking at simulated data in the <code>lavaan</code> package for <code>R</code>.
  </div>
</div>

</header>

<section id="introduction" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">1</span> Introduction</h2>
<p>There is a long tradition in sociology and psychology of using cross-lagged panel models to investigate dynamic processes <span class="citation" data-cites="rogosa1980">(<a href="#ref-rogosa1980" role="doc-biblioref">Rogosa 1980</a>)</span> in structural equation modeling (SEM). These usually look at the lagged bidirectional effects of two variables (cross-lagged paths, CL) while holding the previous values of these variables constant (autoregressive paths, AR).</p>
<p>At the same time, such models have been shown to be biased in the presence of time-invariant unobserved heterogeneity. Effective ways to incorporate time-invariant unobserved heterogeneity into cross-lagged panel models have been around for several decades now <span class="citation" data-cites="bollen2004 curran2001">(e.g., <a href="#ref-bollen2004" role="doc-biblioref">Kenneth A. Bollen and Curran 2004</a>; <a href="#ref-curran2001" role="doc-biblioref">Curran and Bollen 2001</a>)</span> and this topic has experienced renewed interest in the last several years <span class="citation" data-cites="curran2014 hamaker2015">(<a href="#ref-curran2014" role="doc-biblioref">Curran et al. 2014</a>; <a href="#ref-hamaker2015" role="doc-biblioref">Hamaker, Kuiper, and Grasman 2015</a>)</span>.</p>
<p>The basic idea of cross-lagged panel models that account for unobserved time-invariant confounders can also be generalized to ‘unidirectional’ models that focus on the effect of one variable on another while de-emphasizing the question of reverse causality <span class="citation" data-cites="allison2017 moral-benito2018 williams2018">(<a href="#ref-allison2017" role="doc-biblioref">Allison, Williams, and Moral-Benito 2017</a>; <a href="#ref-moral-benito2018" role="doc-biblioref">Moral-Benito, Allison, and Williams 2018</a>; <a href="#ref-williams2018" role="doc-biblioref">Williams, Allison, and Moral-Benito 2018</a>)</span>. We could call these ‘dynamic fixed effects’ models because they all account for both unobserved time-invariant heterogeneity as well as state dependence by including the lagged dependent variable (lagged DV or LDV).</p>
<p>Indeed <span class="citation" data-cites="kuehnel2018">(<a href="#ref-kuehnel2018" role="doc-biblioref">Kühnel and Mays 2018</a>)</span> argue that the inclusion of the LDV make such models more desirable than ‘static fixed effects’ models (which do not include the lagged dependent variable) because they potentially account for confounding by certain time-varying variables, as well.</p>
<p>Still, many are skeptical of the use of such models. Often, the skepticism centers directly on the use of the LDV. Indeed, many articles warn of including the LDV in a panel regression model <span class="citation" data-cites="bruederl2014 dafoe2014 foster2010 dafoe2015 collischon2020 keele2006 leszczensky2019b mouw2006 walters2019">(e.g., <a href="#ref-bruederl2014" role="doc-biblioref">Brüderl and Ludwig 2014</a>; <a href="#ref-dafoe2014" role="doc-biblioref">Dafoe 2014</a>, <a href="#ref-dafoe2015" role="doc-biblioref">2015</a>; <a href="#ref-foster2010" role="doc-biblioref">Foster 2010</a>; <a href="#ref-collischon2020" role="doc-biblioref">Collischon and Eberl 2020</a>; <a href="#ref-keele2006" role="doc-biblioref">Keele and Kelly 2006</a>; <a href="#ref-leszczensky2019b" role="doc-biblioref">Leszczensky and Wolbring 2019</a>; <a href="#ref-mouw2006" role="doc-biblioref">Mouw 2006</a>; <a href="#ref-walters2019" role="doc-biblioref">Walters 2019</a>)</span>. One of the most convincing arguments is given by <span class="citation" data-cites="morgan2014">Morgan and Winship (<a href="#ref-morgan2014" role="doc-biblioref">2014, 111</a>, Figure 4.3)</span>. There, they show that the inclusion of the LDV may bias the causal effect of interest in the presence of time-invariant unobserved heterogeneity.</p>
<p>In this brief article, we will outline the arguments for and against the inclusion of the LDV and then show that the usual SEM approach to panel modelling is not generally affected by the criticism. We hope to convince readers of the usefulness of the broad class of (cross-lagged) dynamic panel models with fixed effects in SEM.</p>
</section>
<section id="benefits-of-the-ldv" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="benefits-of-the-ldv"><span class="header-section-number">2</span> Benefits of the LDV</h2>
<p>Consider an empirical example by <span class="citation" data-cites="coleman1982">Coleman, Hoffer, and Kilgore (<a href="#ref-coleman1982" role="doc-biblioref">1982</a>)</span> and outlined in <span class="citation" data-cites="morgan2014">Morgan and Winship (<a href="#ref-morgan2014" role="doc-biblioref">2014</a>)</span>. There, Coleman and colleagues were looking to assess the causal effect of attending a Catholic school as opposed to public school on achievement, as measured by pupils’ test scores. The direct acyclic graph (DAG) shown in Figure <span class="math inline">\(\ref{fig-ldv-1}\)</span> summarizes their hypothesized data generating process (DGP), where black circles represent observed variables and white ones unobserved variables.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<div class="quarto-layout-panel">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-ldv-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="ldv-1.png" class="img-fluid figure-img" data-ref-parent="fig-dag-1"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">(a) Without LDV</figcaption><p></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-ldv-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="ldv-2.png" class="img-fluid figure-img" data-ref-parent="fig-dag-1"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">(b) With LDV</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 1: Catholic school example from <span class="citation" data-cites="coleman1982">Coleman, Hoffer, and Kilgore (<a href="#ref-coleman1982" role="doc-biblioref">1982</a>)</span></figcaption><p></p>
</figure>
</div>
<p>In this DAG, <span class="math inline">\(Y_{10}\)</span> represents the pupil’s test score in grade 10, <span class="math inline">\(X\)</span> are observed determinants of test scores and <span class="math inline">\(O\)</span> are observed background factors that influence test scores, the determinants of test scores, the selection of school system, as well as the unobserved factors in <span class="math inline">\(U\)</span>. For its part, <span class="math inline">\(U\)</span> could contain any number of potentially umeasured things like motivation or intelligence, that would impact the choice of school system (Catholic schools might prefer to admit intelligent pupils) and the pupil’s test scores themselves.</p>
<p>Conditioning on <span class="math inline">\(X\)</span> and <span class="math inline">\(O\)</span> would close all back-door paths except <span class="math inline">\(Y_{10} \leftarrow D \leftarrow U \rightarrow Y_{10}\)</span>. Because <span class="math inline">\(U\)</span> contains all the unobserved determinants of the causal variable and the outcome, it cannot be conditioned on and the causal effect of interest is unidentified <span class="citation" data-cites="morgan2014">(<a href="#ref-morgan2014" role="doc-biblioref">Morgan and Winship 2014, 270</a>)</span>.</p>
<p><span class="citation" data-cites="coleman1982">Coleman, Hoffer, and Kilgore (<a href="#ref-coleman1982" role="doc-biblioref">1982</a>)</span> came to a solution to this problem by collecting data on the pupils’ test scores two years later, in grade 12. By looking at the DAG in Figure <span class="math inline">\(\ref{fig-ldv-2}\)</span>, we can see that <span class="math inline">\(Y_{10}\)</span> “screen[s] off the effects of the variables in <span class="math inline">\(U\)</span> on <span class="math inline">\(Y_{12}\)</span>” <span class="citation" data-cites="morgan2014">(<a href="#ref-morgan2014" role="doc-biblioref">Morgan and Winship 2014, 270</a>)</span>. Indeed, by focusing on test scores in grade 12 and including the lagged measure from grade 10 in the model, the back-door paths over the unobservables in <span class="math inline">\(U\)</span> are blocked and the causal effect of <span class="math inline">\(D\)</span> on <span class="math inline">\(Y_{12}\)</span> is identified.</p>
<p>Note that <span class="math inline">\(U\)</span> could potentially include the unmeasured outcome even further in the past. In this way, the inclusion of the lagged dependent variable also accounts for endogeneity, where the causal variable is impacted by previous outcomes. An example given by <span class="citation" data-cites="wooldridge2012">Wooldridge (<a href="#ref-wooldridge2012" role="doc-biblioref">2012, 313</a>)</span> concerns the explanation of crime as a function of police expenditure. It is plausible that more is spent on policing in areas where crime rates have been high in the past. Simply regressing the crime rate on expenditure will likely be misleading, because where there is a high crime rate, there will be increased spending, so the effect of spending on crime may even be positive.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> Including the lagged crime rate allows for an intuitive interpretation of the effect of expenditure: it is the difference in crime rate between two hypothetical cities with the same crime rate in the previous period given a unit change in expenditure <span class="citation" data-cites="wooldridge2012">(<a href="#ref-wooldridge2012" role="doc-biblioref">Wooldridge 2012</a>)</span>.</p>
</section>
<section id="arguments-against-the-ldv" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="arguments-against-the-ldv"><span class="header-section-number">3</span> Arguments Against the LDV</h2>
<p>To continue with outlining the issue, let us turn to a simpler DAG as shown in Figure <span class="math inline">\(\ref{fig-ldv-3}\)</span>, which is adapted also from <span class="citation" data-cites="morgan2014">Morgan and Winship (<a href="#ref-morgan2014" role="doc-biblioref">2014, 111</a>, Fig. 4,3)</span>.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> In this DAG, we have dropped the observed variables captured in <span class="math inline">\(X\)</span> and <span class="math inline">\(O\)</span> from above. Since they are observed, we can drop them from the following discussion without loss of generality. We still have <span class="math inline">\(D\)</span>, the causal variable of interest, and two measures of the outcome, represented by <span class="math inline">\(Y_{1}\)</span> and <span class="math inline">\(Y_{2}\)</span>. Consistent with the Catholic school example, the inclusion of <span class="math inline">\(Y_{1}\)</span> as an observed predictor of <span class="math inline">\(Y_{2}\)</span> closes the back-door path across <span class="math inline">\(D \leftarrow U \rightarrow Y_{1} \rightarrow Y_{2}\)</span>.</p>
<div id="fig-ldv-3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="ldv-3.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 2: Lagged DV as collider from <span class="citation" data-cites="morgan2014">Morgan and Winship (<a href="#ref-morgan2014" role="doc-biblioref">2014</a>)</span></figcaption><p></p>
</figure>
</div>
<p>The novelty of this DAG compared to the previous ones is the inclusion of <span class="math inline">\(V\)</span>. It represents the time-invariant unobserved heterogeneity. It is an unobserved variable that affects the outcome at all points in time. It can also be thought of as the combined effect of all the time-invariant factors affecting the outcome. The issue, outlined in <span class="citation" data-cites="morgan2014">Morgan and Winship (<a href="#ref-morgan2014" role="doc-biblioref">2014</a>)</span>, is that if <span class="math inline">\(V\)</span> is unobserved, then <span class="math inline">\(Y_{1}\)</span> is also a collider variable and controlling for it therefore opens a new back-door path over <span class="math inline">\(V\)</span>, rendering the causal effect biased.</p>
<p>This point is often the one criticisms of the LDV focus on. <span class="citation" data-cites="keele2006">Keele and Kelly (<a href="#ref-keele2006" role="doc-biblioref">2006, 187</a>)</span> write, for example, that “[e]ven when a lagged dependent variable is theoretically appropriate, remaining residual autocorrelation can lead to biased coefficient results.” Here, the remaining residual autocorrelation is the time-invariant unobserved heterogeneity; the unobserved stable factors that cause the outcome to be correlated with itself over time <span class="citation" data-cites="andersen2022">(<a href="#ref-andersen2022" role="doc-biblioref">Andersen 2022</a>)</span>. <span class="citation" data-cites="foster2010">Foster (<a href="#ref-foster2010" role="doc-biblioref">2010, 1467</a>)</span> echos this, stating “[s]uch analyses [that include the LDV] are problematic. As has long been known in economics and other fields, in the presence of autocorrelation (a relationship between unobservables over time), the resulting estimates have poor statistical properties.” <span class="citation" data-cites="collischon2020">Collischon and Eberl (<a href="#ref-collischon2020" role="doc-biblioref">2020, 297</a>)</span> argue against the LDV in a similar fashion.</p>
<p>The intuition for these arguments can be shown easily. To simplify things, let us assume variables are mean centered and scaled to have a variance of one, as <span class="citation" data-cites="cinelli2022">Cinelli, Forney, and Pearl (<a href="#ref-cinelli2022" role="doc-biblioref">2022</a>)</span> do. Then, by path tracing, labelling the structural coefficients <span class="math inline">\(\lambda\)</span>, the covariances of the observed variables, <span class="math inline">\(Y_{2}, Y_{1}, D\)</span> are given by</p>
<span class="math display">\[\begin{align}
\sigma_{Y_{2}D} &amp; = \lambda_{DY_{2}} + \lambda_{UD}\lambda_{UY_{1}}\lambda_{Y_{1}Y_{2}} \\
\sigma_{DY_{1}} &amp; = \lambda_{UD}\lambda_{UY_{1}} \\
\sigma_{Y_{2}Y_{1}} &amp; = \lambda_{Y_{1}Y_{2}} + \lambda_{VY_{1}}\lambda_{VY_{2}} + \lambda_{UY_{1}}\lambda_{UD}\lambda_{DY_{2}}.
\end{align}\]</span>
<p>The partial coefficient of the causal variable, <span class="math inline">\(D\)</span>, on the outcome, <span class="math inline">\(Y_{2}\)</span>, controlling for <span class="math inline">\(Y_{1}\)</span>, is given by</p>
<span class="math display">\[\begin{align}
\beta_{Y_{2}D \cdot Y_{1}} &amp; = \frac{\sigma_{Y_{2}D} - \sigma_{DY_{1}}\sigma_{Y_{2}Y_{1}}}{1 - \sigma^{2}_{DY_{1}}}
\end{align}\]</span>
<p><span class="citation" data-cites="cinelli2022">(<a href="#ref-cinelli2022" role="doc-biblioref">Cinelli, Forney, and Pearl 2022</a>)</span> which, after substitution, works out to</p>
<span class="math display">\[\begin{align}
\beta_{Y_{2}D \cdot Y_{1}} &amp; = \lambda_{DY_{2}} - \frac{\lambda_{UD}\lambda_{UY_{1}}\lambda_{VY_{1}}\lambda_{VY_{2}}}{1 - (\lambda_{UD}\lambda_{VY_{1}})^{2}}
\end{align}\]</span>
<p>which does not equal the structural coefficient <span class="math inline">\(\lambda_{DY_{2}}\)</span>, the average causal effect.</p>
<p>This shows the bias resulting from the LDV and <span class="citation" data-cites="dafoe2015">Dafoe (<a href="#ref-dafoe2015" role="doc-biblioref">2015, 139</a>)</span> suggests that it is therefore only safe to include the LDV when it is not a collider. That is the case when either “there are no unobserved common causes of treatment and the lagged outcome” (if <span class="math inline">\(U\)</span> were missing from the DAG in Figure <span class="math inline">\(\ref{fig-ldv-3}\)</span>) or “no unobserved persistent causes of the outcome” (if <span class="math inline">\(V\)</span> were missing). Partly because of this (along with other theoretical reasons), <span class="citation" data-cites="bruederl2014">Brüderl and Ludwig (<a href="#ref-bruederl2014" role="doc-biblioref">2014, 342</a>)</span> propose flatly that “LDV models are not useful at all.”</p>
</section>
<section id="the-structural-equation-modeling-approach" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="the-structural-equation-modeling-approach"><span class="header-section-number">4</span> The Structural Equation Modeling Approach</h2>
<p>The key to the SEM approach, and the reason why cross-lagged and other panel models that include the LDV are so widespread in SEM, has to do with the fact that by using latent variables, the LDV does not open an unblocked back-door path. Panel models in SEM that account for time-invariant unobserved heterogeneity normally work by specifying a latent variable that causes the observed outcome at all points in time. This explicitly accounts for the “remaining residual autocorrelation” <span class="citation" data-cites="keele2006">(<a href="#ref-keele2006" role="doc-biblioref">Keele and Kelly 2006, 187</a>)</span>, or “persistent causes of the outcome” <span class="citation" data-cites="dafoe2015">(<a href="#ref-dafoe2015" role="doc-biblioref">Dafoe 2015, 139</a>)</span>.</p>
<p>In SEM, the time-invariant unobserved heterogeneity is not unobserved in the classical sense. It represents the conditional (on the other observed variables) covariance between the outcome and itself over time <span class="citation" data-cites="andersen2022">(<a href="#ref-andersen2022" role="doc-biblioref">Andersen 2022</a>)</span>. Say we had the linear model</p>
<span class="math display">\[\begin{align}
y_{it} &amp; = \mathbf{x}_{it}\pmb{\beta} + \alpha_{i} + \epsilon_{it}, \ i = 1, \ldots, N, \ t = 1, \ldots, T
\end{align}\]</span>
<p>where <span class="math inline">\(\mathbf{x}_{it} = (d_{it}, y_{it-1})\)</span> and <span class="math inline">\(\pmb{\beta} = (\beta, \rho)^{\intercal}\)</span>, <span class="math inline">\(\alpha_{i}\)</span> is a latent variable representing the stable factors that change between individuals but not within them, and <span class="math inline">\(\epsilon_{it}\)</span> is the time-varying error component. Then the covariance of any two columns of the wide-format outcome, conditional on the observed covariates, is just</p>
<span class="math display">\[\begin{align}
\text{Cov}(y_{it},y_{is} | \mathbf{x}_{it}) = \text{Var}(\alpha_{i}), \ t \ne s
\end{align}\]</span>
<p>since we normally assume <span class="math inline">\(\text{Cov}(\epsilon_{it},\epsilon_{is}) = 0, \ t \ne s\)</span> and <span class="math inline">\(\text{Cov}(\epsilon_{it},\alpha_{i}) = 0, \ t = 1, \ldots, T\)</span>.</p>
<p>The SEM approach to modelling time-invariant unobserved heterogeneity as a latent variable in dynamic models relies on our ability to decompose the correlations observed between columns of the wide-format outcome into a part that is due to unobserved time-invariant factors, and the autoregressive component.</p>
<p>This works most reliably when the outcome is at equilibrium, i.e., where the variances and covariances between adjacent columns of the outcome (means, as well, if the mean structure is being analyzed) are not changing drastically from one point in time to the other <span class="citation" data-cites="andersen2021">(<a href="#ref-andersen2021" role="doc-biblioref">Andersen 2021</a>)</span>. <span class="citation" data-cites="ou2017">Ou et al. (<a href="#ref-ou2017" role="doc-biblioref">2017</a>)</span> refer to such processes as “ongoing stationary.” If the process is not ongoing stationary, then the covariance between adjacent columns of the outcome will be changing, and it may be difficult for the model to properly estimate the autoregressive effect, along with the variance of the latent variable representing the stable factors, see again <span class="citation" data-cites="andersen2021">Andersen (<a href="#ref-andersen2021" role="doc-biblioref">2021</a>)</span>.</p>
<p>To ensure both sources of covariance between columns of the wide-format outcome can be properly accounted for, it is advantageous if the process is ongoing stationary, and even better when there are sufficient observations of the outcome over time (ideally more than two).</p>
<p>While these conditions may sound restrictive at first, they simply reflect the assumptions that there are relatively stable individual levels/trajectories around which the temporal measures tend to hover, and that deviations from these tend to revert back to that underlying level/trajectory <span class="citation" data-cites="andersen2021">(<a href="#ref-andersen2021" role="doc-biblioref">Andersen 2021, 6</a>)</span>. And these are basically baked-in to the DGP displayed in Figure <span class="math inline">\(\ref{fig-ldv-3}\)</span>, which indeed features an autoregressive effect as well as stable factors affecting the outcome over time. In fact, we can look at Figure <span class="math inline">\(\ref{fig-ldv-3}\)</span> as a ‘close-up’ of the overall DGP, focusing in on two measures of the outcome, as hardly any conceivable phenomena in the social sciences occur in such a vacuum.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
<p>More on the method for accounting for stable unobserved characteristics in panel models in SEM has been outlined elsewhere <span class="citation" data-cites="allison2011 andersen2022 bollen2010 teachman2001">(e.g., <a href="#ref-allison2011" role="doc-biblioref">Allison 2011</a>; <a href="#ref-andersen2022" role="doc-biblioref">Andersen 2022</a>; <a href="#ref-bollen2010" role="doc-biblioref">K. A. Bollen and Brand 2010</a>; <a href="#ref-teachman2001" role="doc-biblioref">Teachman et al. 2001</a>)</span>, so we will not describe it in detail here. Instead, we show that by explicitly modeling the time-invariant unobserved heterogeneity, the causal effect of interest can be estimated without bias.</p>
</section>
<section id="a-simulated-example" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="a-simulated-example"><span class="header-section-number">5</span> A Simulated Example</h2>
<p>We construct a simulated dataset to demonstrate the use of SEM in accounting for time-varying and invariant confounders. To ensure the outcome is ongoing stationary, we simulate a ‘spin-up’ phase to allow the variances and covariances to reach equilibrium. Figure <span class="math inline">\(\ref{fig-ldv-4}\)</span> shows the simulated DGP, where the initial outcomes, <span class="math inline">\(Y_{0}-Y_{4}\)</span> are treated as ‘unobserved.’ That is, we focus on three measures of the outcome over time, <span class="math inline">\(Y_{5} - Y_{7}\)</span>, along with the causal variable, <span class="math inline">\(D\)</span>, and account for the unobserved variables <span class="math inline">\(U\)</span> and <span class="math inline">\(V\)</span> indirectly.</p>
<div id="fig-ldv-4" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="ldv-4.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 3: Simulated DGP</figcaption><p></p>
</figure>
</div>
<p>We look at linear additive effects. The exogenous variables, as well as the errors, are standard normal. The effect sizes were chosen arbitrarily and can be seen in the code below. The main causal effect of interest, <span class="math inline">\(D \rightarrow Y7\)</span> is set to the value 0.4.<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Set seed </span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">set.seed</span>(<span class="dv">45678</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co"># Load packages </span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-7"><a href="#cb1-7"></a></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co"># Set large sample size </span></span>
<span id="cb1-9"><a href="#cb1-9"></a>n <span class="ot">&lt;-</span> 1000L</span>
<span id="cb1-10"><a href="#cb1-10"></a></span>
<span id="cb1-11"><a href="#cb1-11"></a>rho   <span class="ot">=</span> <span class="fl">0.3</span> <span class="co"># Autoregressive effect</span></span>
<span id="cb1-12"><a href="#cb1-12"></a>gamma <span class="ot">=</span> <span class="fl">0.6</span> <span class="co"># Effect U -&gt; D</span></span>
<span id="cb1-13"><a href="#cb1-13"></a>delta <span class="ot">=</span> <span class="fl">0.5</span> <span class="co"># Effect U -&gt; Y6</span></span>
<span id="cb1-14"><a href="#cb1-14"></a>beta  <span class="ot">=</span> <span class="fl">0.4</span> <span class="co"># Causal effect of interest</span></span>
<span id="cb1-15"><a href="#cb1-15"></a></span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="co"># Time-invariant unobserved heterogeneity </span></span>
<span id="cb1-17"><a href="#cb1-17"></a>V <span class="ot">=</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb1-18"><a href="#cb1-18"></a></span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="co"># Simulate spin-up phase to allow Yt to reach equilibrium</span></span>
<span id="cb1-20"><a href="#cb1-20"></a>Y0 <span class="ot">=</span> <span class="dv">1</span> <span class="sc">*</span> V <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb1-21"><a href="#cb1-21"></a>Y1 <span class="ot">=</span> rho <span class="sc">*</span> Y0 <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> V <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb1-22"><a href="#cb1-22"></a>Y2 <span class="ot">=</span> rho <span class="sc">*</span> Y1 <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> V <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb1-23"><a href="#cb1-23"></a>Y3 <span class="ot">=</span> rho <span class="sc">*</span> Y2 <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> V <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb1-24"><a href="#cb1-24"></a>Y4 <span class="ot">=</span> rho <span class="sc">*</span> Y3 <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> V <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb1-25"><a href="#cb1-25"></a>Y5 <span class="ot">=</span> rho <span class="sc">*</span> Y4 <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> V <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb1-26"><a href="#cb1-26"></a></span>
<span id="cb1-27"><a href="#cb1-27"></a><span class="co"># Time-varying confounder </span></span>
<span id="cb1-28"><a href="#cb1-28"></a>U <span class="ot">=</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb1-29"><a href="#cb1-29"></a></span>
<span id="cb1-30"><a href="#cb1-30"></a><span class="co"># Causal variable </span></span>
<span id="cb1-31"><a href="#cb1-31"></a>D <span class="ot">=</span> gamma <span class="sc">*</span> U <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb1-32"><a href="#cb1-32"></a></span>
<span id="cb1-33"><a href="#cb1-33"></a><span class="co"># Focus on effect D -&gt; Y7, holding Y6 constant </span></span>
<span id="cb1-34"><a href="#cb1-34"></a>Y6 <span class="ot">=</span> delta <span class="sc">*</span> U <span class="sc">+</span> rho <span class="sc">*</span> Y5 <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> V <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb1-35"><a href="#cb1-35"></a>Y7 <span class="ot">=</span> beta  <span class="sc">*</span> D <span class="sc">+</span> rho <span class="sc">*</span> Y6 <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> V <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb1-36"><a href="#cb1-36"></a></span>
<span id="cb1-37"><a href="#cb1-37"></a><span class="co"># Put into dataframe</span></span>
<span id="cb1-38"><a href="#cb1-38"></a>df <span class="ot">=</span> <span class="fu">data.frame</span>(Y0, Y1, Y2, Y3, Y4, Y5, Y6, Y7, D, V, U)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Obviously, if both <span class="math inline">\(U\)</span> and <span class="math inline">\(V\)</span> were observed, then we could estimate the model without bias. We can estimate the entire model simultaneously in SEM using the <code>lavaan</code> package in <code>R</code>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>m1 <span class="ot">=</span> <span class="st">"</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="st">  Y7 ~ beta*D + rho*Y6 + V </span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="st">  Y6 ~ delta*U + V</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="st">  D  ~ gamma*U </span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="st">"</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>m1.fit <span class="ot">=</span> <span class="fu">sem</span>(<span class="at">model =</span> m1, <span class="at">data =</span> df, <span class="at">estimator =</span> <span class="st">"ML"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-7"><a href="#cb2-7"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-11 ended normally after 2 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         9
                                                      
  Number of observations                          1000
                                                      
Model Test User Model:
                                                      
  Test statistic                                 5.641
  Degrees of freedom                                 3
  P-value (Chi-square)                           0.130

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  Y7 ~                                                
    D       (beta)    0.435    0.028   15.659    0.000
    Y6       (rho)    0.308    0.029   10.810    0.000
    V                 1.019    0.052   19.704    0.000
  Y6 ~                                                
    U       (delt)    0.457    0.033   13.741    0.000
    V                 1.457    0.033   43.592    0.000
  D ~                                                 
    U       (gamm)    0.597    0.032   18.704    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .Y7                1.002    0.045   22.361    0.000
   .Y6                1.082    0.048   22.361    0.000
   .D                 1.007    0.045   22.361    0.000</code></pre>
</div>
</div>
<div class="cell">

</div>
<p>Here, the causal effect of interest (labeled <code>beta</code>) is unbiased at about 0.435 (the slight discrepancy is due to sampling error).</p>
<p>Now, to see the point <span class="citation" data-cites="morgan2014">Morgan and Winship (<a href="#ref-morgan2014" role="doc-biblioref">2014</a>)</span> were making, let us assume <span class="math inline">\(V\)</span> is unobserved. Including the lagged dependent variable will close the back-door path over <span class="math inline">\(U\)</span> but the bias will still be present because <span class="math inline">\(V\)</span> is unobserved.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>m2 <span class="ot">=</span> <span class="st">"</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="st">  Y7 ~ beta*D + rho*Y6 </span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="st">  Y6 ~ delta*U </span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="st">  D  ~ gamma*U </span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="st">"</span></span>
<span id="cb4-6"><a href="#cb4-6"></a>m2.fit <span class="ot">=</span> <span class="fu">sem</span>(<span class="at">model =</span> m2, <span class="at">data =</span> df, <span class="at">estimator =</span> <span class="st">"ML"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-7"><a href="#cb4-7"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-11 ended normally after 1 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         7
                                                      
  Number of observations                          1000
                                                      
Model Test User Model:
                                                      
  Test statistic                                49.244
  Degrees of freedom                                 2
  P-value (Chi-square)                           0.000

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  Y7 ~                                                
    D       (beta)    0.318    0.032    9.923    0.000
    Y6       (rho)    0.748    0.021   35.989    0.000
  Y6 ~                                                
    U       (delt)    0.318    0.056    5.643    0.000
  D ~                                                 
    U       (gamm)    0.597    0.032   18.704    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .Y7                1.388    0.062   22.361    0.000
   .Y6                3.139    0.140   22.361    0.000
   .D                 1.007    0.045   22.361    0.000</code></pre>
</div>
</div>
<div class="cell">

</div>
<p>The effect of <span class="math inline">\(D\)</span> on <span class="math inline">\(Y_{7}\)</span> is biased in this model with an estimated coefficient of 0.318.</p>
<p>In SEM though, <span class="math inline">\(U\)</span> is explicitly accounted for as a latent variable. It represents the correlation of the outcome with itself over time, over and above the lagged causal variable and the autoregressive effect. In the following model, both <span class="math inline">\(U\)</span> and <span class="math inline">\(V\)</span> are still treated as unobserved.</p>
<p>We specify a latent variable to account for time-invariant unobserved heterogeneity with <code>alpha =~ 1*Y6 + 1*Y7</code> and regress <code>Y7</code> on both <code>D</code> and <code>Y6</code>. We include <code>Y5</code> in the model as an exogenous variable, allowing it to covary freely with the stable factors represented by <code>alpha</code>. Allowing the initial observation to covary freely with the stable factors accounts for situations in which the outcome is not yet at equilibrium, see <span class="citation" data-cites="andersen2021">Andersen (<a href="#ref-andersen2021" role="doc-biblioref">2021</a>)</span> and it is the common approach in dynamic models <span class="citation" data-cites="allison2017">(e.g., <a href="#ref-allison2017" role="doc-biblioref">Allison, Williams, and Moral-Benito 2017</a>)</span>. Including <code>Y5</code> and regressing <code>Y6</code> on it further helps the model better differentiate the autoregressive from the stable unit effects.</p>
<p>Note that we use the name <code>alpha</code> here instead of <code>V</code> because <code>lavaan</code> will usually return an error if one of the names of the latent variables overlaps with the name of one of the observed variables.</p>
<p>Finally, since <code>U</code> is now also unobserved, we allow <code>Y6</code> and <code>D</code> to covary to account for this common cause. Figure <span class="math inline">\(\ref{fig-ldv-5}\)</span> shows the SEM approach graphically.</p>
<div id="fig-ldv-5" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="ldv-5.png" class="img-fluid figure-img"></p>
<p></p><figcaption aria-hidden="true" class="figure-caption">Figure 4: Modelling strategy in SEM (m3.fit)</figcaption><p></p>
</figure>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>m3 <span class="ot">=</span> <span class="st">"</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="st">  # Individual effects to account for V</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="st">  alpha =~ 1*Y6 + 1*Y7</span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="st">  # Regressions </span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="st">  Y7 ~ beta*D + rho*Y6</span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="st">  Y6 ~ rho*Y5</span></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="st">  # Allow initial outcome to correlate with unit effects</span></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="st">  alpha ~~ Y5</span></span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="st">  # Account for U, common cause of Y6 and D </span></span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="st">  D ~~ Y6</span></span>
<span id="cb6-11"><a href="#cb6-11"></a><span class="st">"</span></span>
<span id="cb6-12"><a href="#cb6-12"></a>m3.fit <span class="ot">=</span> <span class="fu">sem</span>(<span class="at">model =</span> m3, <span class="at">data =</span> df, <span class="at">estimator =</span> <span class="st">"ML"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb6-13"><a href="#cb6-13"></a>  <span class="fu">summary</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-11 ended normally after 35 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        10
  Number of equality constraints                     1
                                                      
  Number of observations                          1000
                                                      
Model Test User Model:
                                                      
  Test statistic                                 3.311
  Degrees of freedom                                 1
  P-value (Chi-square)                           0.069

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  alpha =~                                            
    Y6                1.000                           
    Y7                1.000                           

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  Y7 ~                                                
    D       (beta)    0.428    0.036   11.758    0.000
    Y6       (rho)    0.162    0.092    1.761    0.078
  Y6 ~                                                
    Y5       (rho)    0.162    0.092    1.761    0.078

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  alpha ~~                                            
    Y5                1.773    0.264    6.713    0.000
 .Y6 ~~                                               
    D                 0.226    0.047    4.795    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .Y6                1.005    0.157    6.404    0.000
   .Y7                0.891    0.069   12.957    0.000
    D                 1.360    0.061   22.361    0.000
    Y5                3.102    0.139   22.361    0.000
    alpha             1.607    0.434    3.700    0.000</code></pre>
</div>
</div>
<div class="cell">

</div>
<p>Now, the estimate of the causal effect is relatively close to the true parameter at 0.428. And this is not a fluke: we can draw many samples to show that the estimated coefficient is approximately equal to the causal effect.</p>
<div class="cell" data-hash="lagged-dv_cache/html/unnamed-chunk-8_ea16367db9d063df7fee66a8b8a4656f">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>sim_func <span class="ot">=</span> <span class="cf">function</span>(<span class="at">rho =</span> <span class="fl">0.3</span>, <span class="at">beta =</span> <span class="fl">0.4</span>, <span class="at">gamma =</span> <span class="fl">0.6</span>, <span class="at">delta =</span> <span class="fl">0.5</span>) {</span>
<span id="cb8-2"><a href="#cb8-2"></a>  </span>
<span id="cb8-3"><a href="#cb8-3"></a>  <span class="co"># Set large sample size </span></span>
<span id="cb8-4"><a href="#cb8-4"></a>  n <span class="ot">&lt;-</span> 1000L</span>
<span id="cb8-5"><a href="#cb8-5"></a></span>
<span id="cb8-6"><a href="#cb8-6"></a>  <span class="co"># Time-invariant unobserved heterogeneity </span></span>
<span id="cb8-7"><a href="#cb8-7"></a>  V <span class="ot">=</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb8-8"><a href="#cb8-8"></a></span>
<span id="cb8-9"><a href="#cb8-9"></a>  <span class="co"># Simulate spin-up phase to allow Yt to reach equilibrium</span></span>
<span id="cb8-10"><a href="#cb8-10"></a>  Y0 <span class="ot">=</span> <span class="dv">1</span> <span class="sc">*</span> V <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb8-11"><a href="#cb8-11"></a>  Y1 <span class="ot">=</span> rho <span class="sc">*</span> Y0 <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> V <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb8-12"><a href="#cb8-12"></a>  Y2 <span class="ot">=</span> rho <span class="sc">*</span> Y1 <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> V <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb8-13"><a href="#cb8-13"></a>  Y3 <span class="ot">=</span> rho <span class="sc">*</span> Y2 <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> V <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb8-14"><a href="#cb8-14"></a>  Y4 <span class="ot">=</span> rho <span class="sc">*</span> Y3 <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> V <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb8-15"><a href="#cb8-15"></a>  Y5 <span class="ot">=</span> rho <span class="sc">*</span> Y4 <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> V <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb8-16"><a href="#cb8-16"></a></span>
<span id="cb8-17"><a href="#cb8-17"></a>  <span class="co"># Time-varying confounder </span></span>
<span id="cb8-18"><a href="#cb8-18"></a>  U <span class="ot">=</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb8-19"><a href="#cb8-19"></a></span>
<span id="cb8-20"><a href="#cb8-20"></a>  <span class="co"># Causal variable </span></span>
<span id="cb8-21"><a href="#cb8-21"></a>  D <span class="ot">=</span> gamma <span class="sc">*</span> U <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb8-22"><a href="#cb8-22"></a></span>
<span id="cb8-23"><a href="#cb8-23"></a>  <span class="co"># Focus on effect D -&gt; Y7, holding Y6 constant </span></span>
<span id="cb8-24"><a href="#cb8-24"></a>  Y6 <span class="ot">=</span> delta <span class="sc">*</span> U <span class="sc">+</span> rho <span class="sc">*</span> Y5 <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> V <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb8-25"><a href="#cb8-25"></a>  Y7 <span class="ot">=</span> beta  <span class="sc">*</span> D <span class="sc">+</span> rho <span class="sc">*</span> Y6 <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> V <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb8-26"><a href="#cb8-26"></a></span>
<span id="cb8-27"><a href="#cb8-27"></a>  <span class="co"># Put into dataframe</span></span>
<span id="cb8-28"><a href="#cb8-28"></a>  df <span class="ot">=</span> <span class="fu">data.frame</span>(Y0, Y1, Y2, Y3, Y4, Y5, Y6, Y7, D, V, U)</span>
<span id="cb8-29"><a href="#cb8-29"></a>  </span>
<span id="cb8-30"><a href="#cb8-30"></a>  <span class="co"># Fit the model </span></span>
<span id="cb8-31"><a href="#cb8-31"></a>  mx <span class="ot">=</span> <span class="st">"</span></span>
<span id="cb8-32"><a href="#cb8-32"></a><span class="st">    # Individual effects to account for V</span></span>
<span id="cb8-33"><a href="#cb8-33"></a><span class="st">    alpha =~ 1*Y6 + 1*Y7</span></span>
<span id="cb8-34"><a href="#cb8-34"></a><span class="st">    # Regressions </span></span>
<span id="cb8-35"><a href="#cb8-35"></a><span class="st">    Y7 ~ beta*D + rho*Y6</span></span>
<span id="cb8-36"><a href="#cb8-36"></a><span class="st">    Y6 ~ rho*Y5</span></span>
<span id="cb8-37"><a href="#cb8-37"></a><span class="st">    # Allow initial outcome to correlate with unit effects</span></span>
<span id="cb8-38"><a href="#cb8-38"></a><span class="st">    alpha ~~ Y5</span></span>
<span id="cb8-39"><a href="#cb8-39"></a><span class="st">    # Account for U, common cause of Y6 and D </span></span>
<span id="cb8-40"><a href="#cb8-40"></a><span class="st">    D ~~ Y6</span></span>
<span id="cb8-41"><a href="#cb8-41"></a><span class="st">  "</span></span>
<span id="cb8-42"><a href="#cb8-42"></a>  mx.fit <span class="ot">=</span> <span class="fu">sem</span>(<span class="at">model =</span> mx, <span class="at">data =</span> df, <span class="at">estimator =</span> <span class="st">"ML"</span>)</span>
<span id="cb8-43"><a href="#cb8-43"></a>  </span>
<span id="cb8-44"><a href="#cb8-44"></a>  <span class="co"># Get estimate of beta</span></span>
<span id="cb8-45"><a href="#cb8-45"></a>  est <span class="ot">=</span> <span class="fu">lavInspect</span>(mx.fit, <span class="st">"list"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-46"><a href="#cb8-46"></a>    <span class="fu">filter</span>(op <span class="sc">==</span> <span class="st">"~"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-47"><a href="#cb8-47"></a>    <span class="fu">filter</span>(label <span class="sc">==</span> <span class="st">"beta"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb8-48"><a href="#cb8-48"></a>    <span class="fu">select</span>(est) <span class="sc">%&gt;%</span></span>
<span id="cb8-49"><a href="#cb8-49"></a>    <span class="fu">as.numeric</span>()</span>
<span id="cb8-50"><a href="#cb8-50"></a>  </span>
<span id="cb8-51"><a href="#cb8-51"></a>  <span class="co"># Return estimate of beta</span></span>
<span id="cb8-52"><a href="#cb8-52"></a>  <span class="fu">return</span>(est)</span>
<span id="cb8-53"><a href="#cb8-53"></a>}</span>
<span id="cb8-54"><a href="#cb8-54"></a></span>
<span id="cb8-55"><a href="#cb8-55"></a>res <span class="ot">=</span> <span class="fu">replicate</span>(<span class="at">n =</span> 10000L, <span class="at">expr =</span> <span class="fu">sim_func</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We can see that the estimated coefficient is unbiased:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">mean</span>(res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.3991025</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">median</span>(res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.39942</code></pre>
</div>
</div>
<p>and approximately normally distributed around the true structural coefficient of 0.4:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">hist</span>(res, <span class="at">breaks =</span> <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="lagged-dv_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="conclusion" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="conclusion"><span class="header-section-number">6</span> Conclusion</h2>
<p>The goal of this article was to renew the reader’s confidence in the use of LDVs in panel models. As we discussed, there are good reasons to consider doing so. From a theoretical standpoint, LDVs can capture inertial effects <span class="citation" data-cites="wooldridge2012">(<a href="#ref-wooldridge2012" role="doc-biblioref">Wooldridge 2012, 313</a>)</span> where there is expected to be carry-over of the outcome at one point in time to the next <span class="citation" data-cites="keele2006">(<a href="#ref-keele2006" role="doc-biblioref">Keele and Kelly 2006</a>)</span>. The inclusion of the LDV also gives the main coefficient of interest a desirably intuitive interpretation: a comparison of outcomes between hypothetical units that displayed the same outcome in the previous period, but whose values on the causal variable differ. But perhaps most importantly, the LDV can be effective at closing back-door paths due to unobserved time-varying confounders.</p>
<p>The practice of including the LDV is often criticized and for good reason. In the presence of time-invariant unobserved heterogeneity, the LDV acts as a collider and opens up an unintended back-door path, thus biasing the estimate of the causal effect. But leaving the LDV out means the onus is on the researcher to measure all the potential time-varying confounders, so you’re often “damned if you do, damned if you don’t” <span class="citation" data-cites="cinelli2022">(<a href="#ref-cinelli2022" role="doc-biblioref">Cinelli, Forney, and Pearl 2022</a>)</span>.</p>
<p>The SEM approach gets around this specific criticism of the LDV by explicitly accounting for time-invariant unobserved heterogeneity. This blocks both back-door paths, across (certain) time-varying confounders and time-invariant ones. Thus, the wide use of cross-lagged and other panel models in SEM that account for LDVs is arguably justified.</p>
<p>LDVs are not a silver bullet, however. The researcher’s qualitative hypotheses must hold, as always. The LDV will stop confounding if the simplified DAG in Figure <span class="math inline">\(\ref{fig-ldv-3}\)</span> (or something equivalent, such as Figure <span class="math inline">\(\ref{fig-ldv-4}\)</span>) is the true DGP. If the unobserved time-varying confounders affect the current outcome over and above the mediated path over the lagged version, then another unblocked path is opened up. And other assumptions, like the appropriateness of a linear model, must be scrutinized in SEM just as in any other methodology <span class="citation" data-cites="bollen2013">(<a href="#ref-bollen2013" role="doc-biblioref">Kenneth A. Bollen and Pearl 2013</a>)</span>.</p>
<p>Finally, we did not look at other potential approaches to LDVs, such as the Arellano-Bond (AB) differenced model (which is perhaps the most promising approach outside of SEM), which tries to use lags even further back from the current outcome as instruments <span class="citation" data-cites="bruederl2014">(<a href="#ref-bruederl2014" role="doc-biblioref">Brüderl and Ludwig 2014</a>)</span>. In a series of simulations, <span class="citation" data-cites="leszczensky2019b">Leszczensky and Wolbring (<a href="#ref-leszczensky2019b" role="doc-biblioref">2019</a>)</span> showed that AB and SEM both performed well under a wide variety of underlying DGPs and assumptions.</p>
<p>Instead, this paper chose to draw attention to an apparently overlooked aspect. At this very moment, a researcher at a sociological conference is likely being alerted to the fact that the LDV is a collider and that their SEM and its results are biased. We believe this should not be a blanket criticism, and that SEM provides a flexible framework for modeling various dynamic processes that suit researchers’ qualitative hypotheses.</p>
</section>
<section id="references" class="level2" data-number="7">

<!-- -->


</section>


<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography"><h2 class="anchored quarto-appendix-heading">7 References</h2><div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-allison2011" class="csl-entry" role="doc-biblioentry">
Allison, Paul D. 2011. <em>Fixed Effects Regression Models</em>. Los Angeles, London: Sage Publications.
</div>
<div id="ref-allison2017" class="csl-entry" role="doc-biblioentry">
Allison, Paul D., Richard Williams, and Enrique Moral-Benito. 2017. <span>“Maximum Likelihood for Cross-Lagged Panel Models with Fixed Effects.”</span> <em>Socius: Sociological Research for a Dynamic World</em> 3 (January): 237802311771057. <a href="https://doi.org/10.1177/2378023117710578">https://doi.org/10.1177/2378023117710578</a>.
</div>
<div id="ref-andersen2021" class="csl-entry" role="doc-biblioentry">
Andersen, Henrik Kenneth. 2021. <span>“Equivalent Approaches to Dealing with Unobserved Heterogeneity in Cross-Lagged Panel Models? Investigating the Benefits and Drawbacks of the Latent Curve Model with Structured Residuals and the Random Intercept Cross-Lagged Panel Model.”</span> <em>Psychological Methods</em> Advanced online publication. <a href="https://doi.org/10.1037/met0000285">https://doi.org/10.1037/met0000285</a>.
</div>
<div id="ref-andersen2022" class="csl-entry" role="doc-biblioentry">
———. 2022. <span>“A Closer Look at Random and Fixed Effects Panel Regression in Structural Equation Modeling Using Lavaan.”</span> <em>Structural Equation Modeling: A Multidisciplinary Journal</em> 29 (3): 476–86. <a href="https://doi.org/10.1080/10705511.2021.1963255">https://doi.org/10.1080/10705511.2021.1963255</a>.
</div>
<div id="ref-bollen2010" class="csl-entry" role="doc-biblioentry">
Bollen, K. A., and J. E. Brand. 2010. <span>“A General Panel Model with Random and Fixed Effects: A Structural Equations Approach.”</span> <em>Social Forces</em> 89 (1): 1–34. <a href="https://doi.org/10.1353/sof.2010.0072">https://doi.org/10.1353/sof.2010.0072</a>.
</div>
<div id="ref-bollen2004" class="csl-entry" role="doc-biblioentry">
Bollen, Kenneth A., and Patrick J. Curran. 2004. <span>“Autoregressive Latent Trajectory (ALT) Models A Synthesis of Two Traditions.”</span> <em>Sociological Methods &amp; Research</em> 32 (3): 336–83. <a href="https://doi.org/10.1177/0049124103260222">https://doi.org/10.1177/0049124103260222</a>.
</div>
<div id="ref-bollen2013" class="csl-entry" role="doc-biblioentry">
Bollen, Kenneth A., and Judea Pearl. 2013. <span>“Eight Myths about Causality and Structural Equation Models.”</span> In <em>Handbook of Causal Analysis for Social Research</em>, edited by Stephen L. Morgan, 301–28. Dordrecht: Springer Science+Business Media.
</div>
<div id="ref-bruederl2014" class="csl-entry" role="doc-biblioentry">
Brüderl, Josef, and Volker Ludwig. 2014. <span>“Fixed-Effects Panel Regression.”</span> In, 327–58. SAGE Publications Ltd. <a href="https://doi.org/10.4135/9781446288146.n15">https://doi.org/10.4135/9781446288146.n15</a>.
</div>
<div id="ref-cinelli2022" class="csl-entry" role="doc-biblioentry">
Cinelli, Carlos, Andrew Forney, and Judea Pearl. 2022. <span>“A Crash Course in Good and Bad Controls.”</span> June 3, 2022. <a href="https://www.researchgate.net/publication/340082755_A_Crash_Course_in_Good_and_Bad_Controls">https://www.researchgate.net/publication/340082755_A_Crash_Course_in_Good_and_Bad_Controls</a>.
</div>
<div id="ref-coleman1982" class="csl-entry" role="doc-biblioentry">
Coleman, James S., Thomas Hoffer, and Sally Kilgore. 1982. <em>High School Achievement: Public, Catholic, and Private Schools Compared</em>. New York: Basic Books.
</div>
<div id="ref-collischon2020" class="csl-entry" role="doc-biblioentry">
Collischon, Matthias, and Andreas Eberl. 2020. <span>“Let’s Talk About Fixed Effects: Let’s Talk About All the Good Things and the Bad Things.”</span> <em>KZfSS Kölner Zeitschrift Für Soziologie Und Sozialpsychologie</em> 72 (2): 289–99. <a href="https://doi.org/10.1007/s11577-020-00699-8">https://doi.org/10.1007/s11577-020-00699-8</a>.
</div>
<div id="ref-curran2001" class="csl-entry" role="doc-biblioentry">
Curran, Patrick J., and Kenneth A. Bollen. 2001. <span>“The Best of Both Worlds: Combining Autoregressive and Latent Curve Models.”</span> In, 107–35. American Psychological Association. <a href="https://doi.org/10.1037/10409-004">https://doi.org/10.1037/10409-004</a>.
</div>
<div id="ref-curran2014" class="csl-entry" role="doc-biblioentry">
Curran, Patrick J., Andrea L. Howard, Sierra A. Bainter, Stephanie T. Lane, and James S. McGinley. 2014. <span>“The Separation of Between-Person and Within-Person Components of Individual Change over Time: A Latent Curve Model with Structured Residuals.”</span> <em>Journal of Consulting and Clinical Psychology</em> 82 (5): 879–94. <a href="https://doi.org/10.1037/a0035297">https://doi.org/10.1037/a0035297</a>.
</div>
<div id="ref-dafoe2014" class="csl-entry" role="doc-biblioentry">
Dafoe, Allan. 2014. <span>“Prescriptions for Temporal Dependence: First Do No Harm.”</span> <em>SSRN Electronic Journal</em>. <a href="https://doi.org/10.2139/ssrn.2422871">https://doi.org/10.2139/ssrn.2422871</a>.
</div>
<div id="ref-dafoe2015" class="csl-entry" role="doc-biblioentry">
———. 2015. <span>“Nonparametric Identification of Causal Effects Under Temporal Dependence.”</span> <em>Sociological Methods &amp; Research</em> 47 (2): 136–68. <a href="https://doi.org/10.1177/0049124115613784">https://doi.org/10.1177/0049124115613784</a>.
</div>
<div id="ref-foster2010" class="csl-entry" role="doc-biblioentry">
Foster, E. Michael. 2010. <span>“Causal Inference and Developmental Psychology.”</span> <em>Developmental Psychology</em> 46 (6): 1454–80. <a href="https://doi.org/10.1037/a0020204">https://doi.org/10.1037/a0020204</a>.
</div>
<div id="ref-hamaker2015" class="csl-entry" role="doc-biblioentry">
Hamaker, Ellen L., Rebecca M. Kuiper, and Raoul P. P. P. Grasman. 2015. <span>“A Critique of the Cross-Lagged Panel Model.”</span> <em>Psychological Methods</em> 20 (1): 102–16. <a href="https://doi.org/10.1037/a0038889">https://doi.org/10.1037/a0038889</a>.
</div>
<div id="ref-keele2006" class="csl-entry" role="doc-biblioentry">
Keele, Luke, and Nathan J. Kelly. 2006. <span>“Dynamic Models for Dynamic Theories: The Ins and Outs of Lagged Dependent Variables.”</span> <em>Political Analysis</em> 14 (2): 186–205. <a href="https://doi.org/10.1093/pan/mpj006">https://doi.org/10.1093/pan/mpj006</a>.
</div>
<div id="ref-kuehnel2018" class="csl-entry" role="doc-biblioentry">
Kühnel, Steffen, and Anja Mays. 2018. <span>“Probleme von Cross-Lagged Panelmodellen Zur Analyse Gegenseitiger Beeinflussung von Einstellung Und Verhalten.”</span> In, 359–86. Springer Fachmedien Wiesbaden. <a href="https://doi.org/10.1007/978-3-658-16348-8_15">https://doi.org/10.1007/978-3-658-16348-8_15</a>.
</div>
<div id="ref-leszczensky2019b" class="csl-entry" role="doc-biblioentry">
Leszczensky, Lars, and Tobias Wolbring. 2019. <span>“How to Deal With Reverse Causality Using Panel Data? Recommendations for Researchers Based on a Simulation Study.”</span> <em>Sociological Methods &amp; Research</em> 51 (2): 837–65. <a href="https://doi.org/10.1177/0049124119882473">https://doi.org/10.1177/0049124119882473</a>.
</div>
<div id="ref-moral-benito2018" class="csl-entry" role="doc-biblioentry">
Moral-Benito, Enrique, Paul Allison, and Richard Williams. 2018. <span>“Dynamic Panel Data Modelling Using Maximum Likelihood: An Alternative to Arellano-Bond.”</span> <em>Applied Economics</em> 51 (20): 2221–32. <a href="https://doi.org/10.1080/00036846.2018.1540854">https://doi.org/10.1080/00036846.2018.1540854</a>.
</div>
<div id="ref-morgan2014" class="csl-entry" role="doc-biblioentry">
Morgan, Stephen L., and Christopher Winship. 2014. <span>“Counterfactuals and Causal Inference.”</span> <a href="https://doi.org/10.1017/cbo9781107587991">https://doi.org/10.1017/cbo9781107587991</a>.
</div>
<div id="ref-mouw2006" class="csl-entry" role="doc-biblioentry">
Mouw, Ted. 2006. <span>“Estimating the Causal Effect of Social Capital: A Review of Recent Research.”</span> <em>Annual Review of Sociology</em> 32 (1): 79–102. <a href="https://doi.org/10.1146/annurev.soc.32.061604.123150">https://doi.org/10.1146/annurev.soc.32.061604.123150</a>.
</div>
<div id="ref-ou2017" class="csl-entry" role="doc-biblioentry">
Ou, Lu, Sy-Miin Chow, Linying Ji, and Peter C. M. Molenaar. 2017. <span>“(Re)evaluating the Implications of the Autoregressive Latent Trajectory Model Through Likelihood Ratio Tests of Its Initial Conditions.”</span> <em>Multivariate Behavioral Research</em> 52 (2): 178–99. <a href="https://doi.org/10.1080/00273171.2016.1259980">https://doi.org/10.1080/00273171.2016.1259980</a>.
</div>
<div id="ref-rogosa1980" class="csl-entry" role="doc-biblioentry">
Rogosa, David. 1980. <span>“A Critique of Cross-Lagged Correlation.”</span> <em>Psychological Bulletin</em> 88 (2): 245–58. <a href="https://doi.org/10.1037/0033-2909.88.2.245">https://doi.org/10.1037/0033-2909.88.2.245</a>.
</div>
<div id="ref-teachman2001" class="csl-entry" role="doc-biblioentry">
Teachman, Jay, Greg J. Duncan, Jean Yeung, and Dan Levy. 2001. <span>“Covariance Structure Models for Fixed and Random Effects.”</span> <em>Sociological Methods and Research</em> 30 (2): 271–88. <a href="https://doi.org/10.1177/0049124101030002005">https://doi.org/10.1177/0049124101030002005</a>.
</div>
<div id="ref-walters2019" class="csl-entry" role="doc-biblioentry">
Walters, Glenn D. 2019. <span>“Criminal Thinking as a Moderator of the Perceived Certainty<span></span>offending Relationship: Age Variations.”</span> <em>Psychology, Crime &amp; Law</em> 26 (3): 267–86. <a href="https://doi.org/10.1080/1068316x.2019.1652749">https://doi.org/10.1080/1068316x.2019.1652749</a>.
</div>
<div id="ref-williams2018" class="csl-entry" role="doc-biblioentry">
Williams, Richard, Paul D. Allison, and Enrique Moral-Benito. 2018. <span>“Linear Dynamic Panel-Data Estimation Using Maximum Likelihood and Structural Equation Modeling.”</span> <em>The Stata Journal: Promoting Communications on Statistics and Stata</em> 18 (2): 293–326. <a href="https://doi.org/10.1177/1536867x1801800201">https://doi.org/10.1177/1536867x1801800201</a>.
</div>
<div id="ref-wooldridge2012" class="csl-entry" role="doc-biblioentry">
Wooldridge, Jeffrey M. 2012. <em>Introductory Econometrics: A Modern Approach, 5th Edition</em>. Mason: South-Western.
</div>
</div></section><section class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1" role="doc-endnote"><p>Empirical examples chosen for this article were taken from the helpful video tutorial on LDVs by Mikko Rönkkö, <a href="https://www.youtube.com/watch?v=DhV5otUB3Jc" class="uri">https://www.youtube.com/watch?v=DhV5otUB3Jc</a>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p>This is not to justify police expenditure, which is a difficult topic in some parts of the world. It may still be that police spending has a positive causal effect on crime, or that there is no tangible effect. But the estimated effect in a simple regression of current crime rate on current expenditure will likely be biased in one way or another.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3" role="doc-endnote"><p>The same thing is shown in the variation of Model 7 in <span class="citation" data-cites="cinelli2022">Cinelli, Forney, and Pearl (<a href="#ref-cinelli2022" role="doc-biblioref">2022</a>)</span>, where <span class="math inline">\(Z\)</span> takes the place of the LDV.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4" role="doc-endnote"><p>E.g., if we refer back to the examples mentioned above, we would assume stable factors affect the pupils’ test scores not just in grades 10 and 12, but also in earlier grades, as well. And police expenditure likely hovers around a fairly stable level for long periods of time, based on stable unobserved characteristics of the city.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5" role="doc-endnote"><p>Normally, it is assumed that the effect of the time-invariant unobserved factors is constant over time. This assumption is reflected in the usual practice of fixing the factor loadings from the latent variable to the outcome to 1.0 at each point in time <span class="citation" data-cites="andersen2022 bollen2010">(<a href="#ref-andersen2022" role="doc-biblioref">Andersen 2022</a>; <a href="#ref-bollen2010" role="doc-biblioref">K. A. Bollen and Brand 2010</a>)</span>. This assumption can be easily relaxed by allowing the factor loadings to be estimated freely after the first point in time. We retain it here as it is consistent with the simulated DGP.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section><section class="quarto-appendix-contents"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{kennethandersen,
  author = {Henrik Kenneth Andersen and Jochen Mayerl},
  title = {Rehabilitating the {Lagged} {Dependent} {Variable} with
    {Structural} {Equation} {Modeling}},
  date = {},
  langid = {en},
  abstract = {It has been argued that including the lagged dependent
    variable in panel models will open up unintended back-door paths and
    bias the estimates of the causal variable. We show that panel
    analysis in the structural equation modeling framework gets around
    this issue. Including the lagged dependent variable has the benefit
    of closing back-door paths due to unobserved time-varying
    confounders. We demonstrate this by looking at simulated data in the
    `lavaan` package for `R`.}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-kennethandersen" class="csl-entry quarto-appendix-citeas" role="doc-biblioentry">
Henrik Kenneth Andersen, and Jochen Mayerl. n.d. <span>“Rehabilitating
the Lagged Dependent Variable with Structural Equation Modeling.”</span>
</div></div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb14" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb14-1"><a href="#cb14-1"></a><span class="co">---</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="an">title:</span><span class="co"> "Rehabilitating the Lagged Dependent Variable with Structural Equation Modeling"</span></span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="an">author:</span><span class="co"> </span></span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="co">  - name: Henrik Kenneth Andersen </span></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="co">    affiliation: Chemnitz University of Technology </span></span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="co">    orcid: 0000-0001-6842-5337</span></span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="co">  - name: Jochen Mayerl </span></span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="co">    affiliation: Chemnitz University of Technology </span></span>
<span id="cb14-9"><a href="#cb14-9"></a><span class="co">    orcid: 0000-0002-4599-9976 </span></span>
<span id="cb14-10"><a href="#cb14-10"></a><span class="an">abstract:</span><span class="co"> "It has been argued that including the lagged dependent variable in panel models will open up unintended back-door paths and bias the estimates of the causal variable. We show that panel analysis in the structural equation modeling framework gets around this issue. Including the lagged dependent variable has the benefit of closing back-door paths due to unobserved time-varying confounders. We demonstrate this by looking at simulated data in the `lavaan` package for `R`."</span></span>
<span id="cb14-11"><a href="#cb14-11"></a><span class="an">citation:</span><span class="co"> true</span></span>
<span id="cb14-12"><a href="#cb14-12"></a><span class="an">date:</span><span class="co"> '`r format(Sys.Date())`'</span></span>
<span id="cb14-13"><a href="#cb14-13"></a><span class="an">toc:</span><span class="co"> true</span></span>
<span id="cb14-14"><a href="#cb14-14"></a><span class="an">number-sections:</span><span class="co"> true</span></span>
<span id="cb14-15"><a href="#cb14-15"></a><span class="an">highlight-style:</span><span class="co"> pygments </span></span>
<span id="cb14-16"><a href="#cb14-16"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb14-17"><a href="#cb14-17"></a><span class="co">  html:</span></span>
<span id="cb14-18"><a href="#cb14-18"></a><span class="co">    documentclass: scrartcl</span></span>
<span id="cb14-19"><a href="#cb14-19"></a><span class="co">    papersize: a4</span></span>
<span id="cb14-20"><a href="#cb14-20"></a><span class="co">    code-tools: true </span></span>
<span id="cb14-21"><a href="#cb14-21"></a><span class="co">    code-fold: true</span></span>
<span id="cb14-22"><a href="#cb14-22"></a><span class="co">    code-line-numbers: true</span></span>
<span id="cb14-23"><a href="#cb14-23"></a><span class="co">    colorlinks: true </span></span>
<span id="cb14-24"><a href="#cb14-24"></a><span class="co">    link-citations: true</span></span>
<span id="cb14-25"><a href="#cb14-25"></a><span class="an">editor:</span><span class="co"> visual</span></span>
<span id="cb14-26"><a href="#cb14-26"></a><span class="an">bibliography:</span><span class="co"> references.bib</span></span>
<span id="cb14-27"><a href="#cb14-27"></a><span class="co">---</span></span>
<span id="cb14-28"><a href="#cb14-28"></a></span>
<span id="cb14-29"><a href="#cb14-29"></a><span class="fu">## Introduction</span></span>
<span id="cb14-30"><a href="#cb14-30"></a></span>
<span id="cb14-31"><a href="#cb14-31"></a>There is a long tradition in sociology and psychology of using cross-lagged panel models to investigate dynamic processes <span class="co">[</span><span class="ot">@rogosa1980</span><span class="co">]</span> in structural equation modeling (SEM). These usually look at the lagged bidirectional effects of two variables (cross-lagged paths, CL) while holding the previous values of these variables constant (autoregressive paths, AR).</span>
<span id="cb14-32"><a href="#cb14-32"></a></span>
<span id="cb14-33"><a href="#cb14-33"></a>At the same time, such models have been shown to be biased in the presence of time-invariant unobserved heterogeneity. Effective ways to incorporate time-invariant unobserved heterogeneity into cross-lagged panel models have been around for several decades now <span class="co">[</span><span class="ot">e.g., @bollen2004; @curran2001</span><span class="co">]</span> and this topic has experienced renewed interest in the last several years <span class="co">[</span><span class="ot">@curran2014; @hamaker2015</span><span class="co">]</span>.</span>
<span id="cb14-34"><a href="#cb14-34"></a></span>
<span id="cb14-35"><a href="#cb14-35"></a>The basic idea of cross-lagged panel models that account for unobserved time-invariant confounders can also be generalized to 'unidirectional' models that focus on the effect of one variable on another while de-emphasizing the question of reverse causality <span class="co">[</span><span class="ot">@allison2017; @moral-benito2018; @williams2018</span><span class="co">]</span>. We could call these 'dynamic fixed effects' models because they all account for both unobserved time-invariant heterogeneity as well as state dependence by including the lagged dependent variable (lagged DV or LDV).</span>
<span id="cb14-36"><a href="#cb14-36"></a></span>
<span id="cb14-37"><a href="#cb14-37"></a>Indeed <span class="co">[</span><span class="ot">@kuehnel2018</span><span class="co">]</span> argue that the inclusion of the LDV make such models more desirable than 'static fixed effects' models (which do not include the lagged dependent variable) because they potentially account for confounding by certain time-varying variables, as well.</span>
<span id="cb14-38"><a href="#cb14-38"></a></span>
<span id="cb14-39"><a href="#cb14-39"></a>Still, many are skeptical of the use of such models. Often, the skepticism centers directly on the use of the LDV. Indeed, many articles warn of including the LDV in a panel regression model <span class="co">[</span><span class="ot">e.g., @bruederl2014; @dafoe2014; @foster2010; @dafoe2015; @collischon2020; @keele2006; @leszczensky2019b; @mouw2006; @walters2019</span><span class="co">]</span>. One of the most convincing arguments is given by @morgan2014 <span class="co">[</span><span class="ot">p. 111, Figure 4.3</span><span class="co">]</span>. There, they show that the inclusion of the LDV may bias the causal effect of interest in the presence of time-invariant unobserved heterogeneity.</span>
<span id="cb14-40"><a href="#cb14-40"></a></span>
<span id="cb14-41"><a href="#cb14-41"></a>In this brief article, we will outline the arguments for and against the inclusion of the LDV and then show that the usual SEM approach to panel modelling is not generally affected by the criticism. We hope to convince readers of the usefulness of the broad class of (cross-lagged) dynamic panel models with fixed effects in SEM.</span>
<span id="cb14-42"><a href="#cb14-42"></a></span>
<span id="cb14-43"><a href="#cb14-43"></a><span class="fu">## Benefits of the LDV</span></span>
<span id="cb14-44"><a href="#cb14-44"></a></span>
<span id="cb14-45"><a href="#cb14-45"></a>Consider an empirical example by @coleman1982 and outlined in @morgan2014. There, Coleman and colleagues were looking to assess the causal effect of attending a Catholic school as opposed to public school on achievement, as measured by pupils' test scores. The direct acyclic graph (DAG) shown in Figure \ref{fig-ldv-1} summarizes their hypothesized data generating process (DGP), where black circles represent observed variables and white ones unobserved variables.<span class="ot">[^1]</span></span>
<span id="cb14-46"><a href="#cb14-46"></a></span>
<span id="cb14-47"><a href="#cb14-47"></a><span class="ot">[^1]: </span>Empirical examples chosen for this article were taken from the helpful video tutorial on LDVs by Mikko Rönkkö, <span class="ot">&lt;https://www.youtube.com/watch?v=DhV5otUB3Jc&gt;</span>.</span>
<span id="cb14-48"><a href="#cb14-48"></a></span>
<span id="cb14-49"><a href="#cb14-49"></a>::: {#fig-dag-1 layout-ncol="2"}</span>
<span id="cb14-50"><a href="#cb14-50"></a><span class="al">![Without LDV](ldv-1.png)</span>{#fig-ldv-1}</span>
<span id="cb14-51"><a href="#cb14-51"></a></span>
<span id="cb14-52"><a href="#cb14-52"></a><span class="al">![With LDV](ldv-2.png)</span>{#fig-ldv-2}</span>
<span id="cb14-53"><a href="#cb14-53"></a></span>
<span id="cb14-54"><a href="#cb14-54"></a>Catholic school example from @coleman1982</span>
<span id="cb14-55"><a href="#cb14-55"></a>:::</span>
<span id="cb14-56"><a href="#cb14-56"></a></span>
<span id="cb14-57"><a href="#cb14-57"></a>In this DAG, $Y_{10}$ represents the pupil's test score in grade 10, $X$ are observed determinants of test scores and $O$ are observed background factors that influence test scores, the determinants of test scores, the selection of school system, as well as the unobserved factors in $U$. For its part, $U$ could contain any number of potentially umeasured things like motivation or intelligence, that would impact the choice of school system (Catholic schools might prefer to admit intelligent pupils) and the pupil's test scores themselves.</span>
<span id="cb14-58"><a href="#cb14-58"></a></span>
<span id="cb14-59"><a href="#cb14-59"></a>Conditioning on $X$ and $O$ would close all back-door paths except $Y_{10} \leftarrow D \leftarrow U \rightarrow Y_{10}$. Because $U$ contains all the unobserved determinants of the causal variable and the outcome, it cannot be conditioned on and the causal effect of interest is unidentified <span class="co">[</span><span class="ot">@morgan2014, 270</span><span class="co">]</span>.</span>
<span id="cb14-60"><a href="#cb14-60"></a></span>
<span id="cb14-61"><a href="#cb14-61"></a>@coleman1982 came to a solution to this problem by collecting data on the pupils' test scores two years later, in grade 12. By looking at the DAG in Figure \ref{fig-ldv-2}, we can see that $Y_{10}$ "screen<span class="sc">\[</span>s<span class="sc">\]</span> off the effects of the variables in $U$ on $Y_{12}$" <span class="co">[</span><span class="ot">@morgan2014, 270</span><span class="co">]</span>. Indeed, by focusing on test scores in grade 12 and including the lagged measure from grade 10 in the model, the back-door paths over the unobservables in $U$ are blocked and the causal effect of $D$ on $Y_{12}$ is identified.</span>
<span id="cb14-62"><a href="#cb14-62"></a></span>
<span id="cb14-63"><a href="#cb14-63"></a>Note that $U$ could potentially include the unmeasured outcome even further in the past. In this way, the inclusion of the lagged dependent variable also accounts for endogeneity, where the causal variable is impacted by previous outcomes. An example given by @wooldridge2012 <span class="co">[</span><span class="ot">313</span><span class="co">]</span> concerns the explanation of crime as a function of police expenditure. It is plausible that more is spent on policing in areas where crime rates have been high in the past. Simply regressing the crime rate on expenditure will likely be misleading, because where there is a high crime rate, there will be increased spending, so the effect of spending on crime may even be positive.<span class="ot">[^2]</span> Including the lagged crime rate allows for an intuitive interpretation of the effect of expenditure: it is the difference in crime rate between two hypothetical cities with the same crime rate in the previous period given a unit change in expenditure <span class="co">[</span><span class="ot">@wooldridge2012</span><span class="co">]</span>.</span>
<span id="cb14-64"><a href="#cb14-64"></a></span>
<span id="cb14-65"><a href="#cb14-65"></a><span class="ot">[^2]: </span>This is not to justify police expenditure, which is a difficult topic in some parts of the world. It may still be that police spending has a positive causal effect on crime, or that there is no tangible effect. But the estimated effect in a simple regression of current crime rate on current expenditure will likely be biased in one way or another.</span>
<span id="cb14-66"><a href="#cb14-66"></a></span>
<span id="cb14-67"><a href="#cb14-67"></a><span class="fu">## Arguments Against the LDV</span></span>
<span id="cb14-68"><a href="#cb14-68"></a></span>
<span id="cb14-69"><a href="#cb14-69"></a>To continue with outlining the issue, let us turn to a simpler DAG as shown in Figure \ref{fig-ldv-3}, which is adapted also from @morgan2014 <span class="co">[</span><span class="ot">p. 111, Fig. 4,3</span><span class="co">]</span>.<span class="ot">[^3]</span> In this DAG, we have dropped the observed variables captured in $X$ and $O$ from above. Since they are observed, we can drop them from the following discussion without loss of generality. We still have $D$, the causal variable of interest, and two measures of the outcome, represented by $Y_{1}$ and $Y_{2}$. Consistent with the Catholic school example, the inclusion of $Y_{1}$ as an observed predictor of $Y_{2}$ closes the back-door path across $D \leftarrow U \rightarrow Y_{1} \rightarrow Y_{2}$.</span>
<span id="cb14-70"><a href="#cb14-70"></a></span>
<span id="cb14-71"><a href="#cb14-71"></a><span class="ot">[^3]: </span>The same thing is shown in the variation of Model 7 in @cinelli2022, where $Z$ takes the place of the LDV.</span>
<span id="cb14-72"><a href="#cb14-72"></a></span>
<span id="cb14-73"><a href="#cb14-73"></a><span class="al">![Lagged DV as collider from @morgan2014](ldv-3.png)</span>{#fig-ldv-3}</span>
<span id="cb14-74"><a href="#cb14-74"></a></span>
<span id="cb14-75"><a href="#cb14-75"></a>The novelty of this DAG compared to the previous ones is the inclusion of $V$. It represents the time-invariant unobserved heterogeneity. It is an unobserved variable that affects the outcome at all points in time. It can also be thought of as the combined effect of all the time-invariant factors affecting the outcome. The issue, outlined in @morgan2014, is that if $V$ is unobserved, then $Y_{1}$ is also a collider variable and controlling for it therefore opens a new back-door path over $V$, rendering the causal effect biased.</span>
<span id="cb14-76"><a href="#cb14-76"></a></span>
<span id="cb14-77"><a href="#cb14-77"></a>This point is often the one criticisms of the LDV focus on. @keele2006 <span class="co">[</span><span class="ot">187</span><span class="co">]</span> write, for example, that "<span class="sc">\[</span>e<span class="sc">\]</span>ven when a lagged dependent variable is theoretically appropriate, remaining residual autocorrelation can lead to biased coefficient results." Here, the remaining residual autocorrelation is the time-invariant unobserved heterogeneity; the unobserved stable factors that cause the outcome to be correlated with itself over time <span class="co">[</span><span class="ot">@andersen2022</span><span class="co">]</span>. @foster2010 <span class="co">[</span><span class="ot">1467</span><span class="co">]</span> echos this, stating "<span class="sc">\[</span>s<span class="sc">\]</span>uch analyses <span class="sc">\[</span>that include the LDV<span class="sc">\]</span> are problematic. As has long been known in economics and other fields, in the presence of autocorrelation (a relationship between unobservables over time), the resulting estimates have poor statistical properties." @collischon2020 <span class="co">[</span><span class="ot">297</span><span class="co">]</span> argue against the LDV in a similar fashion.</span>
<span id="cb14-78"><a href="#cb14-78"></a></span>
<span id="cb14-79"><a href="#cb14-79"></a>The intuition for these arguments can be shown easily. To simplify things, let us assume variables are mean centered and scaled to have a variance of one, as @cinelli2022 do. Then, by path tracing, labelling the structural coefficients $\lambda$, the covariances of the observed variables, $Y_{2}, Y_{1}, D$ are given by</span>
<span id="cb14-80"><a href="#cb14-80"></a></span>
<span id="cb14-81"><a href="#cb14-81"></a><span class="in">```{=tex}</span></span>
<span id="cb14-82"><a href="#cb14-82"></a><span class="in">\begin{align}</span></span>
<span id="cb14-83"><a href="#cb14-83"></a><span class="in">\sigma_{Y_{2}D} &amp; = \lambda_{DY_{2}} + \lambda_{UD}\lambda_{UY_{1}}\lambda_{Y_{1}Y_{2}} \\</span></span>
<span id="cb14-84"><a href="#cb14-84"></a><span class="in">\sigma_{DY_{1}} &amp; = \lambda_{UD}\lambda_{UY_{1}} \\</span></span>
<span id="cb14-85"><a href="#cb14-85"></a><span class="in">\sigma_{Y_{2}Y_{1}} &amp; = \lambda_{Y_{1}Y_{2}} + \lambda_{VY_{1}}\lambda_{VY_{2}} + \lambda_{UY_{1}}\lambda_{UD}\lambda_{DY_{2}}.</span></span>
<span id="cb14-86"><a href="#cb14-86"></a><span class="in">\end{align}</span></span>
<span id="cb14-87"><a href="#cb14-87"></a><span class="in">```</span></span>
<span id="cb14-88"><a href="#cb14-88"></a>The partial coefficient of the causal variable, $D$, on the outcome, $Y_{2}$, controlling for $Y_{1}$, is given by</span>
<span id="cb14-89"><a href="#cb14-89"></a></span>
<span id="cb14-90"><a href="#cb14-90"></a><span class="in">```{=tex}</span></span>
<span id="cb14-91"><a href="#cb14-91"></a><span class="in">\begin{align}</span></span>
<span id="cb14-92"><a href="#cb14-92"></a><span class="in">\beta_{Y_{2}D \cdot Y_{1}} &amp; = \frac{\sigma_{Y_{2}D} - \sigma_{DY_{1}}\sigma_{Y_{2}Y_{1}}}{1 - \sigma^{2}_{DY_{1}}}</span></span>
<span id="cb14-93"><a href="#cb14-93"></a><span class="in">\end{align}</span></span>
<span id="cb14-94"><a href="#cb14-94"></a><span class="in">```</span></span>
<span id="cb14-95"><a href="#cb14-95"></a><span class="co">[</span><span class="ot">@cinelli2022</span><span class="co">]</span> which, after substitution, works out to</span>
<span id="cb14-96"><a href="#cb14-96"></a></span>
<span id="cb14-97"><a href="#cb14-97"></a><span class="in">```{=tex}</span></span>
<span id="cb14-98"><a href="#cb14-98"></a><span class="in">\begin{align}</span></span>
<span id="cb14-99"><a href="#cb14-99"></a><span class="in">\beta_{Y_{2}D \cdot Y_{1}} &amp; = \lambda_{DY_{2}} - \frac{\lambda_{UD}\lambda_{UY_{1}}\lambda_{VY_{1}}\lambda_{VY_{2}}}{1 - (\lambda_{UD}\lambda_{VY_{1}})^{2}} </span></span>
<span id="cb14-100"><a href="#cb14-100"></a><span class="in">\end{align}</span></span>
<span id="cb14-101"><a href="#cb14-101"></a><span class="in">```</span></span>
<span id="cb14-102"><a href="#cb14-102"></a>which does not equal the structural coefficient $\lambda_{DY_{2}}$, the average causal effect.</span>
<span id="cb14-103"><a href="#cb14-103"></a></span>
<span id="cb14-104"><a href="#cb14-104"></a>This shows the bias resulting from the LDV and @dafoe2015 <span class="co">[</span><span class="ot">139</span><span class="co">]</span> suggests that it is therefore only safe to include the LDV when it is not a collider. That is the case when either "there are no unobserved common causes of treatment and the lagged outcome" (if $U$ were missing from the DAG in Figure \ref{fig-ldv-3}) or "no unobserved persistent causes of the outcome" (if $V$ were missing). Partly because of this (along with other theoretical reasons), @bruederl2014 <span class="co">[</span><span class="ot">342</span><span class="co">]</span> propose flatly that "LDV models are not useful at all."</span>
<span id="cb14-105"><a href="#cb14-105"></a></span>
<span id="cb14-106"><a href="#cb14-106"></a><span class="fu">## The Structural Equation Modeling Approach</span></span>
<span id="cb14-107"><a href="#cb14-107"></a></span>
<span id="cb14-108"><a href="#cb14-108"></a>The key to the SEM approach, and the reason why cross-lagged and other panel models that include the LDV are so widespread in SEM, has to do with the fact that by using latent variables, the LDV does not open an unblocked back-door path. Panel models in SEM that account for time-invariant unobserved heterogeneity normally work by specifying a latent variable that causes the observed outcome at all points in time. This explicitly accounts for the "remaining residual autocorrelation" <span class="co">[</span><span class="ot">@keele2006, 187</span><span class="co">]</span>, or "persistent causes of the outcome" <span class="co">[</span><span class="ot">@dafoe2015, 139</span><span class="co">]</span>.</span>
<span id="cb14-109"><a href="#cb14-109"></a></span>
<span id="cb14-110"><a href="#cb14-110"></a>In SEM, the time-invariant unobserved heterogeneity is not unobserved in the classical sense. It represents the conditional (on the other observed variables) covariance between the outcome and itself over time <span class="co">[</span><span class="ot">@andersen2022</span><span class="co">]</span>. Say we had the linear model</span>
<span id="cb14-111"><a href="#cb14-111"></a></span>
<span id="cb14-112"><a href="#cb14-112"></a><span class="in">```{=tex}</span></span>
<span id="cb14-113"><a href="#cb14-113"></a><span class="in">\begin{align}</span></span>
<span id="cb14-114"><a href="#cb14-114"></a><span class="in">y_{it} &amp; = \mathbf{x}_{it}\pmb{\beta} + \alpha_{i} + \epsilon_{it}, \ i = 1, \ldots, N, \ t = 1, \ldots, T</span></span>
<span id="cb14-115"><a href="#cb14-115"></a><span class="in">\end{align}</span></span>
<span id="cb14-116"><a href="#cb14-116"></a><span class="in">```</span></span>
<span id="cb14-117"><a href="#cb14-117"></a>where $\mathbf{x}_{it} = (d_{it}, y_{it-1})$ and $\pmb{\beta} = (\beta, \rho)^{\intercal}$, $\alpha_{i}$ is a latent variable representing the stable factors that change between individuals but not within them, and $\epsilon_{it}$ is the time-varying error component. Then the covariance of any two columns of the wide-format outcome, conditional on the observed covariates, is just</span>
<span id="cb14-118"><a href="#cb14-118"></a></span>
<span id="cb14-119"><a href="#cb14-119"></a><span class="in">```{=tex}</span></span>
<span id="cb14-120"><a href="#cb14-120"></a><span class="in">\begin{align}</span></span>
<span id="cb14-121"><a href="#cb14-121"></a><span class="in">\text{Cov}(y_{it},y_{is} | \mathbf{x}_{it}) = \text{Var}(\alpha_{i}), \ t \ne s</span></span>
<span id="cb14-122"><a href="#cb14-122"></a><span class="in">\end{align}</span></span>
<span id="cb14-123"><a href="#cb14-123"></a><span class="in">```</span></span>
<span id="cb14-124"><a href="#cb14-124"></a>since we normally assume $\text{Cov}(\epsilon_{it},\epsilon_{is}) = 0, \ t \ne s$ and $\text{Cov}(\epsilon_{it},\alpha_{i}) = 0, \ t = 1, \ldots, T$.</span>
<span id="cb14-125"><a href="#cb14-125"></a></span>
<span id="cb14-126"><a href="#cb14-126"></a>The SEM approach to modelling time-invariant unobserved heterogeneity as a latent variable in dynamic models relies on our ability to decompose the correlations observed between columns of the wide-format outcome into a part that is due to unobserved time-invariant factors, and the autoregressive component.</span>
<span id="cb14-127"><a href="#cb14-127"></a></span>
<span id="cb14-128"><a href="#cb14-128"></a>This works most reliably when the outcome is at equilibrium, i.e., where the variances and covariances between adjacent columns of the outcome (means, as well, if the mean structure is being analyzed) are not changing drastically from one point in time to the other <span class="co">[</span><span class="ot">@andersen2021</span><span class="co">]</span>. @ou2017 refer to such processes as "ongoing stationary." If the process is not ongoing stationary, then the covariance between adjacent columns of the outcome will be changing, and it may be difficult for the model to properly estimate the autoregressive effect, along with the variance of the latent variable representing the stable factors, see again @andersen2021.</span>
<span id="cb14-129"><a href="#cb14-129"></a></span>
<span id="cb14-130"><a href="#cb14-130"></a>To ensure both sources of covariance between columns of the wide-format outcome can be properly accounted for, it is advantageous if the process is ongoing stationary, and even better when there are sufficient observations of the outcome over time (ideally more than two).</span>
<span id="cb14-131"><a href="#cb14-131"></a></span>
<span id="cb14-132"><a href="#cb14-132"></a>While these conditions may sound restrictive at first, they simply reflect the assumptions that there are relatively stable individual levels/trajectories around which the temporal measures tend to hover, and that deviations from these tend to revert back to that underlying level/trajectory <span class="co">[</span><span class="ot">@andersen2021, 6</span><span class="co">]</span>. And these are basically baked-in to the DGP displayed in Figure \ref{fig-ldv-3}, which indeed features an autoregressive effect as well as stable factors affecting the outcome over time. In fact, we can look at Figure \ref{fig-ldv-3} as a 'close-up' of the overall DGP, focusing in on two measures of the outcome, as hardly any conceivable phenomena in the social sciences occur in such a vacuum.<span class="ot">[^4]</span></span>
<span id="cb14-133"><a href="#cb14-133"></a></span>
<span id="cb14-134"><a href="#cb14-134"></a><span class="ot">[^4]: </span>E.g., if we refer back to the examples mentioned above, we would assume stable factors affect the pupils' test scores not just in grades 10 and 12, but also in earlier grades, as well. And police expenditure likely hovers around a fairly stable level for long periods of time, based on stable unobserved characteristics of the city.</span>
<span id="cb14-135"><a href="#cb14-135"></a></span>
<span id="cb14-136"><a href="#cb14-136"></a>More on the method for accounting for stable unobserved characteristics in panel models in SEM has been outlined elsewhere <span class="co">[</span><span class="ot">e.g., @allison2011; @andersen2022; @bollen2010; @teachman2001</span><span class="co">]</span>, so we will not describe it in detail here. Instead, we show that by explicitly modeling the time-invariant unobserved heterogeneity, the causal effect of interest can be estimated without bias.</span>
<span id="cb14-137"><a href="#cb14-137"></a></span>
<span id="cb14-138"><a href="#cb14-138"></a><span class="fu">## A Simulated Example</span></span>
<span id="cb14-139"><a href="#cb14-139"></a></span>
<span id="cb14-140"><a href="#cb14-140"></a>We construct a simulated dataset to demonstrate the use of SEM in accounting for time-varying and invariant confounders. To ensure the outcome is ongoing stationary, we simulate a 'spin-up' phase to allow the variances and covariances to reach equilibrium. Figure \ref{fig-ldv-4} shows the simulated DGP, where the initial outcomes, $Y_{0}-Y_{4}$ are treated as 'unobserved.' That is, we focus on three measures of the outcome over time, $Y_{5} - Y_{7}$, along with the causal variable, $D$, and account for the unobserved variables $U$ and $V$ indirectly.</span>
<span id="cb14-141"><a href="#cb14-141"></a></span>
<span id="cb14-142"><a href="#cb14-142"></a><span class="al">![Simulated DGP](ldv-4.png)</span>{#fig-ldv-4}</span>
<span id="cb14-143"><a href="#cb14-143"></a></span>
<span id="cb14-144"><a href="#cb14-144"></a>We look at linear additive effects. The exogenous variables, as well as the errors, are standard normal. The effect sizes were chosen arbitrarily and can be seen in the code below. The main causal effect of interest, $D \rightarrow Y7$ is set to the value 0.4.<span class="ot">[^5]</span></span>
<span id="cb14-145"><a href="#cb14-145"></a></span>
<span id="cb14-146"><a href="#cb14-146"></a><span class="ot">[^5]: </span>Normally, it is assumed that the effect of the time-invariant unobserved factors is constant over time. This assumption is reflected in the usual practice of fixing the factor loadings from the latent variable to the outcome to 1.0 at each point in time <span class="co">[</span><span class="ot">@andersen2022; @bollen2010</span><span class="co">]</span>. This assumption can be easily relaxed by allowing the factor loadings to be estimated freely after the first point in time. We retain it here as it is consistent with the simulated DGP.</span>
<span id="cb14-147"><a href="#cb14-147"></a></span>
<span id="cb14-150"><a href="#cb14-150"></a><span class="in">```{r}</span></span>
<span id="cb14-151"><a href="#cb14-151"></a><span class="co">#| message: false</span></span>
<span id="cb14-152"><a href="#cb14-152"></a><span class="co">#| warning: false</span></span>
<span id="cb14-153"><a href="#cb14-153"></a><span class="co"># Set seed </span></span>
<span id="cb14-154"><a href="#cb14-154"></a><span class="fu">set.seed</span>(<span class="dv">45678</span>)</span>
<span id="cb14-155"><a href="#cb14-155"></a></span>
<span id="cb14-156"><a href="#cb14-156"></a><span class="co"># Load packages </span></span>
<span id="cb14-157"><a href="#cb14-157"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb14-158"><a href="#cb14-158"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb14-159"><a href="#cb14-159"></a></span>
<span id="cb14-160"><a href="#cb14-160"></a><span class="co"># Set large sample size </span></span>
<span id="cb14-161"><a href="#cb14-161"></a>n <span class="ot">&lt;-</span> 1000L</span>
<span id="cb14-162"><a href="#cb14-162"></a></span>
<span id="cb14-163"><a href="#cb14-163"></a>rho   <span class="ot">=</span> <span class="fl">0.3</span> <span class="co"># Autoregressive effect</span></span>
<span id="cb14-164"><a href="#cb14-164"></a>gamma <span class="ot">=</span> <span class="fl">0.6</span> <span class="co"># Effect U -&gt; D</span></span>
<span id="cb14-165"><a href="#cb14-165"></a>delta <span class="ot">=</span> <span class="fl">0.5</span> <span class="co"># Effect U -&gt; Y6</span></span>
<span id="cb14-166"><a href="#cb14-166"></a>beta  <span class="ot">=</span> <span class="fl">0.4</span> <span class="co"># Causal effect of interest</span></span>
<span id="cb14-167"><a href="#cb14-167"></a></span>
<span id="cb14-168"><a href="#cb14-168"></a><span class="co"># Time-invariant unobserved heterogeneity </span></span>
<span id="cb14-169"><a href="#cb14-169"></a>V <span class="ot">=</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb14-170"><a href="#cb14-170"></a></span>
<span id="cb14-171"><a href="#cb14-171"></a><span class="co"># Simulate spin-up phase to allow Yt to reach equilibrium</span></span>
<span id="cb14-172"><a href="#cb14-172"></a>Y0 <span class="ot">=</span> <span class="dv">1</span> <span class="sc">*</span> V <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb14-173"><a href="#cb14-173"></a>Y1 <span class="ot">=</span> rho <span class="sc">*</span> Y0 <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> V <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb14-174"><a href="#cb14-174"></a>Y2 <span class="ot">=</span> rho <span class="sc">*</span> Y1 <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> V <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb14-175"><a href="#cb14-175"></a>Y3 <span class="ot">=</span> rho <span class="sc">*</span> Y2 <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> V <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb14-176"><a href="#cb14-176"></a>Y4 <span class="ot">=</span> rho <span class="sc">*</span> Y3 <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> V <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb14-177"><a href="#cb14-177"></a>Y5 <span class="ot">=</span> rho <span class="sc">*</span> Y4 <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> V <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb14-178"><a href="#cb14-178"></a></span>
<span id="cb14-179"><a href="#cb14-179"></a><span class="co"># Time-varying confounder </span></span>
<span id="cb14-180"><a href="#cb14-180"></a>U <span class="ot">=</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb14-181"><a href="#cb14-181"></a></span>
<span id="cb14-182"><a href="#cb14-182"></a><span class="co"># Causal variable </span></span>
<span id="cb14-183"><a href="#cb14-183"></a>D <span class="ot">=</span> gamma <span class="sc">*</span> U <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb14-184"><a href="#cb14-184"></a></span>
<span id="cb14-185"><a href="#cb14-185"></a><span class="co"># Focus on effect D -&gt; Y7, holding Y6 constant </span></span>
<span id="cb14-186"><a href="#cb14-186"></a>Y6 <span class="ot">=</span> delta <span class="sc">*</span> U <span class="sc">+</span> rho <span class="sc">*</span> Y5 <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> V <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb14-187"><a href="#cb14-187"></a>Y7 <span class="ot">=</span> beta  <span class="sc">*</span> D <span class="sc">+</span> rho <span class="sc">*</span> Y6 <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> V <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb14-188"><a href="#cb14-188"></a></span>
<span id="cb14-189"><a href="#cb14-189"></a><span class="co"># Put into dataframe</span></span>
<span id="cb14-190"><a href="#cb14-190"></a>df <span class="ot">=</span> <span class="fu">data.frame</span>(Y0, Y1, Y2, Y3, Y4, Y5, Y6, Y7, D, V, U)</span>
<span id="cb14-191"><a href="#cb14-191"></a><span class="in">```</span></span>
<span id="cb14-192"><a href="#cb14-192"></a></span>
<span id="cb14-193"><a href="#cb14-193"></a>Obviously, if both $U$ and $V$ were observed, then we could estimate the model without bias. We can estimate the entire model simultaneously in SEM using the <span class="in">`lavaan`</span> package in <span class="in">`R`</span>.</span>
<span id="cb14-194"><a href="#cb14-194"></a></span>
<span id="cb14-197"><a href="#cb14-197"></a><span class="in">```{r}</span></span>
<span id="cb14-198"><a href="#cb14-198"></a><span class="co">#| message: false</span></span>
<span id="cb14-199"><a href="#cb14-199"></a><span class="co">#| warning: false</span></span>
<span id="cb14-200"><a href="#cb14-200"></a>m1 <span class="ot">=</span> <span class="st">"</span></span>
<span id="cb14-201"><a href="#cb14-201"></a><span class="st">  Y7 ~ beta*D + rho*Y6 + V </span></span>
<span id="cb14-202"><a href="#cb14-202"></a><span class="st">  Y6 ~ delta*U + V</span></span>
<span id="cb14-203"><a href="#cb14-203"></a><span class="st">  D  ~ gamma*U </span></span>
<span id="cb14-204"><a href="#cb14-204"></a><span class="st">"</span></span>
<span id="cb14-205"><a href="#cb14-205"></a>m1.fit <span class="ot">=</span> <span class="fu">sem</span>(<span class="at">model =</span> m1, <span class="at">data =</span> df, <span class="at">estimator =</span> <span class="st">"ML"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-206"><a href="#cb14-206"></a>  <span class="fu">summary</span>()</span>
<span id="cb14-207"><a href="#cb14-207"></a><span class="in">```</span></span>
<span id="cb14-208"><a href="#cb14-208"></a></span>
<span id="cb14-211"><a href="#cb14-211"></a><span class="in">```{r}</span></span>
<span id="cb14-212"><a href="#cb14-212"></a><span class="co">#| echo: false</span></span>
<span id="cb14-213"><a href="#cb14-213"></a>m1.fit <span class="ot">=</span> <span class="fu">sem</span>(m1, df)</span>
<span id="cb14-214"><a href="#cb14-214"></a>est1 <span class="ot">=</span> <span class="fu">lavInspect</span>(m1.fit, <span class="st">"list"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-215"><a href="#cb14-215"></a>    <span class="fu">filter</span>(op <span class="sc">==</span> <span class="st">"~"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-216"><a href="#cb14-216"></a>    <span class="fu">filter</span>(label <span class="sc">==</span> <span class="st">"beta"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-217"><a href="#cb14-217"></a>    <span class="fu">select</span>(est) <span class="sc">%&gt;%</span></span>
<span id="cb14-218"><a href="#cb14-218"></a>    <span class="fu">as.numeric</span>()</span>
<span id="cb14-219"><a href="#cb14-219"></a><span class="in">```</span></span>
<span id="cb14-220"><a href="#cb14-220"></a></span>
<span id="cb14-221"><a href="#cb14-221"></a>Here, the causal effect of interest (labeled <span class="in">`beta`</span>) is unbiased at about <span class="in">`r round(est1, 3)`</span> (the slight discrepancy is due to sampling error).</span>
<span id="cb14-222"><a href="#cb14-222"></a></span>
<span id="cb14-223"><a href="#cb14-223"></a>Now, to see the point @morgan2014 were making, let us assume $V$ is unobserved. Including the lagged dependent variable will close the back-door path over $U$ but the bias will still be present because $V$ is unobserved.</span>
<span id="cb14-224"><a href="#cb14-224"></a></span>
<span id="cb14-227"><a href="#cb14-227"></a><span class="in">```{r}</span></span>
<span id="cb14-228"><a href="#cb14-228"></a>m2 <span class="ot">=</span> <span class="st">"</span></span>
<span id="cb14-229"><a href="#cb14-229"></a><span class="st">  Y7 ~ beta*D + rho*Y6 </span></span>
<span id="cb14-230"><a href="#cb14-230"></a><span class="st">  Y6 ~ delta*U </span></span>
<span id="cb14-231"><a href="#cb14-231"></a><span class="st">  D  ~ gamma*U </span></span>
<span id="cb14-232"><a href="#cb14-232"></a><span class="st">"</span></span>
<span id="cb14-233"><a href="#cb14-233"></a>m2.fit <span class="ot">=</span> <span class="fu">sem</span>(<span class="at">model =</span> m2, <span class="at">data =</span> df, <span class="at">estimator =</span> <span class="st">"ML"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-234"><a href="#cb14-234"></a>  <span class="fu">summary</span>()</span>
<span id="cb14-235"><a href="#cb14-235"></a><span class="in">```</span></span>
<span id="cb14-236"><a href="#cb14-236"></a></span>
<span id="cb14-239"><a href="#cb14-239"></a><span class="in">```{r}</span></span>
<span id="cb14-240"><a href="#cb14-240"></a><span class="co">#| echo: false </span></span>
<span id="cb14-241"><a href="#cb14-241"></a>m2.fit <span class="ot">=</span> <span class="fu">sem</span>(m2, df)</span>
<span id="cb14-242"><a href="#cb14-242"></a>est2 <span class="ot">&lt;-</span> <span class="fu">lavInspect</span>(m2.fit, <span class="st">"list"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-243"><a href="#cb14-243"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(label <span class="sc">==</span> <span class="st">"beta"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-244"><a href="#cb14-244"></a>  <span class="fu">select</span>(est) <span class="sc">%&gt;%</span></span>
<span id="cb14-245"><a href="#cb14-245"></a>  <span class="fu">as.numeric</span>()</span>
<span id="cb14-246"><a href="#cb14-246"></a><span class="in">```</span></span>
<span id="cb14-247"><a href="#cb14-247"></a></span>
<span id="cb14-248"><a href="#cb14-248"></a>The effect of $D$ on $Y_{7}$ is biased in this model with an estimated coefficient of <span class="in">`r round(est2, 3)`</span>.</span>
<span id="cb14-249"><a href="#cb14-249"></a></span>
<span id="cb14-250"><a href="#cb14-250"></a>In SEM though, $U$ is explicitly accounted for as a latent variable. It represents the correlation of the outcome with itself over time, over and above the lagged causal variable and the autoregressive effect. In the following model, both $U$ and $V$ are still treated as unobserved.</span>
<span id="cb14-251"><a href="#cb14-251"></a></span>
<span id="cb14-252"><a href="#cb14-252"></a>We specify a latent variable to account for time-invariant unobserved heterogeneity with <span class="in">`alpha =~ 1*Y6 + 1*Y7`</span> and regress <span class="in">`Y7`</span> on both <span class="in">`D`</span> and <span class="in">`Y6`</span>. We include <span class="in">`Y5`</span> in the model as an exogenous variable, allowing it to covary freely with the stable factors represented by <span class="in">`alpha`</span>. Allowing the initial observation to covary freely with the stable factors accounts for situations in which the outcome is not yet at equilibrium, see @andersen2021 and it is the common approach in dynamic models <span class="co">[</span><span class="ot">e.g., @allison2017</span><span class="co">]</span>. Including <span class="in">`Y5`</span> and regressing <span class="in">`Y6`</span> on it further helps the model better differentiate the autoregressive from the stable unit effects.</span>
<span id="cb14-253"><a href="#cb14-253"></a></span>
<span id="cb14-254"><a href="#cb14-254"></a>Note that we use the name <span class="in">`alpha`</span> here instead of <span class="in">`V`</span> because <span class="in">`lavaan`</span> will usually return an error if one of the names of the latent variables overlaps with the name of one of the observed variables.</span>
<span id="cb14-255"><a href="#cb14-255"></a></span>
<span id="cb14-256"><a href="#cb14-256"></a>Finally, since <span class="in">`U`</span> is now also unobserved, we allow <span class="in">`Y6`</span> and <span class="in">`D`</span> to covary to account for this common cause. Figure \ref{fig-ldv-5} shows the SEM approach graphically.</span>
<span id="cb14-257"><a href="#cb14-257"></a></span>
<span id="cb14-258"><a href="#cb14-258"></a><span class="al">![Modelling strategy in SEM (m3.fit)](ldv-5.png)</span>{#fig-ldv-5}</span>
<span id="cb14-259"><a href="#cb14-259"></a></span>
<span id="cb14-262"><a href="#cb14-262"></a><span class="in">```{r}</span></span>
<span id="cb14-263"><a href="#cb14-263"></a>m3 <span class="ot">=</span> <span class="st">"</span></span>
<span id="cb14-264"><a href="#cb14-264"></a><span class="st">  # Individual effects to account for V</span></span>
<span id="cb14-265"><a href="#cb14-265"></a><span class="st">  alpha =~ 1*Y6 + 1*Y7</span></span>
<span id="cb14-266"><a href="#cb14-266"></a><span class="st">  # Regressions </span></span>
<span id="cb14-267"><a href="#cb14-267"></a><span class="st">  Y7 ~ beta*D + rho*Y6</span></span>
<span id="cb14-268"><a href="#cb14-268"></a><span class="st">  Y6 ~ rho*Y5</span></span>
<span id="cb14-269"><a href="#cb14-269"></a><span class="st">  # Allow initial outcome to correlate with unit effects</span></span>
<span id="cb14-270"><a href="#cb14-270"></a><span class="st">  alpha ~~ Y5</span></span>
<span id="cb14-271"><a href="#cb14-271"></a><span class="st">  # Account for U, common cause of Y6 and D </span></span>
<span id="cb14-272"><a href="#cb14-272"></a><span class="st">  D ~~ Y6</span></span>
<span id="cb14-273"><a href="#cb14-273"></a><span class="st">"</span></span>
<span id="cb14-274"><a href="#cb14-274"></a>m3.fit <span class="ot">=</span> <span class="fu">sem</span>(<span class="at">model =</span> m3, <span class="at">data =</span> df, <span class="at">estimator =</span> <span class="st">"ML"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-275"><a href="#cb14-275"></a>  <span class="fu">summary</span>()</span>
<span id="cb14-276"><a href="#cb14-276"></a><span class="in">```</span></span>
<span id="cb14-277"><a href="#cb14-277"></a></span>
<span id="cb14-280"><a href="#cb14-280"></a><span class="in">```{r}</span></span>
<span id="cb14-281"><a href="#cb14-281"></a><span class="co">#| echo: false </span></span>
<span id="cb14-282"><a href="#cb14-282"></a>m3.fit <span class="ot">=</span> <span class="fu">sem</span>(m3, df)</span>
<span id="cb14-283"><a href="#cb14-283"></a>est3 <span class="ot">&lt;-</span> <span class="fu">lavInspect</span>(m3.fit, <span class="st">"list"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-284"><a href="#cb14-284"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(label <span class="sc">==</span> <span class="st">"beta"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-285"><a href="#cb14-285"></a>  <span class="fu">select</span>(est) <span class="sc">%&gt;%</span></span>
<span id="cb14-286"><a href="#cb14-286"></a>  <span class="fu">as.numeric</span>()</span>
<span id="cb14-287"><a href="#cb14-287"></a><span class="in">```</span></span>
<span id="cb14-288"><a href="#cb14-288"></a></span>
<span id="cb14-289"><a href="#cb14-289"></a>Now, the estimate of the causal effect is relatively close to the true parameter at <span class="in">`r round(est3, 3)`</span>. And this is not a fluke: we can draw many samples to show that the estimated coefficient is approximately equal to the causal effect.</span>
<span id="cb14-290"><a href="#cb14-290"></a></span>
<span id="cb14-293"><a href="#cb14-293"></a><span class="in">```{r}</span></span>
<span id="cb14-294"><a href="#cb14-294"></a><span class="co">#| message: false</span></span>
<span id="cb14-295"><a href="#cb14-295"></a><span class="co">#| warning: false</span></span>
<span id="cb14-296"><a href="#cb14-296"></a><span class="co">#| cache: true </span></span>
<span id="cb14-297"><a href="#cb14-297"></a></span>
<span id="cb14-298"><a href="#cb14-298"></a>sim_func <span class="ot">=</span> <span class="cf">function</span>(<span class="at">rho =</span> <span class="fl">0.3</span>, <span class="at">beta =</span> <span class="fl">0.4</span>, <span class="at">gamma =</span> <span class="fl">0.6</span>, <span class="at">delta =</span> <span class="fl">0.5</span>) {</span>
<span id="cb14-299"><a href="#cb14-299"></a>  </span>
<span id="cb14-300"><a href="#cb14-300"></a>  <span class="co"># Set large sample size </span></span>
<span id="cb14-301"><a href="#cb14-301"></a>  n <span class="ot">&lt;-</span> 1000L</span>
<span id="cb14-302"><a href="#cb14-302"></a></span>
<span id="cb14-303"><a href="#cb14-303"></a>  <span class="co"># Time-invariant unobserved heterogeneity </span></span>
<span id="cb14-304"><a href="#cb14-304"></a>  V <span class="ot">=</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb14-305"><a href="#cb14-305"></a></span>
<span id="cb14-306"><a href="#cb14-306"></a>  <span class="co"># Simulate spin-up phase to allow Yt to reach equilibrium</span></span>
<span id="cb14-307"><a href="#cb14-307"></a>  Y0 <span class="ot">=</span> <span class="dv">1</span> <span class="sc">*</span> V <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb14-308"><a href="#cb14-308"></a>  Y1 <span class="ot">=</span> rho <span class="sc">*</span> Y0 <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> V <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb14-309"><a href="#cb14-309"></a>  Y2 <span class="ot">=</span> rho <span class="sc">*</span> Y1 <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> V <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb14-310"><a href="#cb14-310"></a>  Y3 <span class="ot">=</span> rho <span class="sc">*</span> Y2 <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> V <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb14-311"><a href="#cb14-311"></a>  Y4 <span class="ot">=</span> rho <span class="sc">*</span> Y3 <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> V <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb14-312"><a href="#cb14-312"></a>  Y5 <span class="ot">=</span> rho <span class="sc">*</span> Y4 <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> V <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb14-313"><a href="#cb14-313"></a></span>
<span id="cb14-314"><a href="#cb14-314"></a>  <span class="co"># Time-varying confounder </span></span>
<span id="cb14-315"><a href="#cb14-315"></a>  U <span class="ot">=</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb14-316"><a href="#cb14-316"></a></span>
<span id="cb14-317"><a href="#cb14-317"></a>  <span class="co"># Causal variable </span></span>
<span id="cb14-318"><a href="#cb14-318"></a>  D <span class="ot">=</span> gamma <span class="sc">*</span> U <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb14-319"><a href="#cb14-319"></a></span>
<span id="cb14-320"><a href="#cb14-320"></a>  <span class="co"># Focus on effect D -&gt; Y7, holding Y6 constant </span></span>
<span id="cb14-321"><a href="#cb14-321"></a>  Y6 <span class="ot">=</span> delta <span class="sc">*</span> U <span class="sc">+</span> rho <span class="sc">*</span> Y5 <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> V <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb14-322"><a href="#cb14-322"></a>  Y7 <span class="ot">=</span> beta  <span class="sc">*</span> D <span class="sc">+</span> rho <span class="sc">*</span> Y6 <span class="sc">+</span> <span class="dv">1</span> <span class="sc">*</span> V <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb14-323"><a href="#cb14-323"></a></span>
<span id="cb14-324"><a href="#cb14-324"></a>  <span class="co"># Put into dataframe</span></span>
<span id="cb14-325"><a href="#cb14-325"></a>  df <span class="ot">=</span> <span class="fu">data.frame</span>(Y0, Y1, Y2, Y3, Y4, Y5, Y6, Y7, D, V, U)</span>
<span id="cb14-326"><a href="#cb14-326"></a>  </span>
<span id="cb14-327"><a href="#cb14-327"></a>  <span class="co"># Fit the model </span></span>
<span id="cb14-328"><a href="#cb14-328"></a>  mx <span class="ot">=</span> <span class="st">"</span></span>
<span id="cb14-329"><a href="#cb14-329"></a><span class="st">    # Individual effects to account for V</span></span>
<span id="cb14-330"><a href="#cb14-330"></a><span class="st">    alpha =~ 1*Y6 + 1*Y7</span></span>
<span id="cb14-331"><a href="#cb14-331"></a><span class="st">    # Regressions </span></span>
<span id="cb14-332"><a href="#cb14-332"></a><span class="st">    Y7 ~ beta*D + rho*Y6</span></span>
<span id="cb14-333"><a href="#cb14-333"></a><span class="st">    Y6 ~ rho*Y5</span></span>
<span id="cb14-334"><a href="#cb14-334"></a><span class="st">    # Allow initial outcome to correlate with unit effects</span></span>
<span id="cb14-335"><a href="#cb14-335"></a><span class="st">    alpha ~~ Y5</span></span>
<span id="cb14-336"><a href="#cb14-336"></a><span class="st">    # Account for U, common cause of Y6 and D </span></span>
<span id="cb14-337"><a href="#cb14-337"></a><span class="st">    D ~~ Y6</span></span>
<span id="cb14-338"><a href="#cb14-338"></a><span class="st">  "</span></span>
<span id="cb14-339"><a href="#cb14-339"></a>  mx.fit <span class="ot">=</span> <span class="fu">sem</span>(<span class="at">model =</span> mx, <span class="at">data =</span> df, <span class="at">estimator =</span> <span class="st">"ML"</span>)</span>
<span id="cb14-340"><a href="#cb14-340"></a>  </span>
<span id="cb14-341"><a href="#cb14-341"></a>  <span class="co"># Get estimate of beta</span></span>
<span id="cb14-342"><a href="#cb14-342"></a>  est <span class="ot">=</span> <span class="fu">lavInspect</span>(mx.fit, <span class="st">"list"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-343"><a href="#cb14-343"></a>    <span class="fu">filter</span>(op <span class="sc">==</span> <span class="st">"~"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-344"><a href="#cb14-344"></a>    <span class="fu">filter</span>(label <span class="sc">==</span> <span class="st">"beta"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-345"><a href="#cb14-345"></a>    <span class="fu">select</span>(est) <span class="sc">%&gt;%</span></span>
<span id="cb14-346"><a href="#cb14-346"></a>    <span class="fu">as.numeric</span>()</span>
<span id="cb14-347"><a href="#cb14-347"></a>  </span>
<span id="cb14-348"><a href="#cb14-348"></a>  <span class="co"># Return estimate of beta</span></span>
<span id="cb14-349"><a href="#cb14-349"></a>  <span class="fu">return</span>(est)</span>
<span id="cb14-350"><a href="#cb14-350"></a>}</span>
<span id="cb14-351"><a href="#cb14-351"></a></span>
<span id="cb14-352"><a href="#cb14-352"></a>res <span class="ot">=</span> <span class="fu">replicate</span>(<span class="at">n =</span> 10000L, <span class="at">expr =</span> <span class="fu">sim_func</span>())</span>
<span id="cb14-353"><a href="#cb14-353"></a><span class="in">```</span></span>
<span id="cb14-354"><a href="#cb14-354"></a></span>
<span id="cb14-355"><a href="#cb14-355"></a>We can see that the estimated coefficient is unbiased:</span>
<span id="cb14-356"><a href="#cb14-356"></a></span>
<span id="cb14-359"><a href="#cb14-359"></a><span class="in">```{r}</span></span>
<span id="cb14-360"><a href="#cb14-360"></a><span class="fu">mean</span>(res)</span>
<span id="cb14-361"><a href="#cb14-361"></a><span class="fu">median</span>(res)</span>
<span id="cb14-362"><a href="#cb14-362"></a><span class="in">```</span></span>
<span id="cb14-363"><a href="#cb14-363"></a></span>
<span id="cb14-364"><a href="#cb14-364"></a>and approximately normally distributed around the true structural coefficient of 0.4:</span>
<span id="cb14-365"><a href="#cb14-365"></a></span>
<span id="cb14-368"><a href="#cb14-368"></a><span class="in">```{r}</span></span>
<span id="cb14-369"><a href="#cb14-369"></a><span class="fu">hist</span>(res, <span class="at">breaks =</span> <span class="dv">30</span>)</span>
<span id="cb14-370"><a href="#cb14-370"></a><span class="in">```</span></span>
<span id="cb14-371"><a href="#cb14-371"></a></span>
<span id="cb14-372"><a href="#cb14-372"></a><span class="fu">## Conclusion</span></span>
<span id="cb14-373"><a href="#cb14-373"></a></span>
<span id="cb14-374"><a href="#cb14-374"></a>The goal of this article was to renew the reader's confidence in the use of LDVs in panel models. As we discussed, there are good reasons to consider doing so. From a theoretical standpoint, LDVs can capture inertial effects <span class="co">[</span><span class="ot">@wooldridge2012, 313</span><span class="co">]</span> where there is expected to be carry-over of the outcome at one point in time to the next <span class="co">[</span><span class="ot">@keele2006</span><span class="co">]</span>. The inclusion of the LDV also gives the main coefficient of interest a desirably intuitive interpretation: a comparison of outcomes between hypothetical units that displayed the same outcome in the previous period, but whose values on the causal variable differ. But perhaps most importantly, the LDV can be effective at closing back-door paths due to unobserved time-varying confounders.</span>
<span id="cb14-375"><a href="#cb14-375"></a></span>
<span id="cb14-376"><a href="#cb14-376"></a>The practice of including the LDV is often criticized and for good reason. In the presence of time-invariant unobserved heterogeneity, the LDV acts as a collider and opens up an unintended back-door path, thus biasing the estimate of the causal effect. But leaving the LDV out means the onus is on the researcher to measure all the potential time-varying confounders, so you're often "damned if you do, damned if you don't" <span class="co">[</span><span class="ot">@cinelli2022</span><span class="co">]</span>.</span>
<span id="cb14-377"><a href="#cb14-377"></a></span>
<span id="cb14-378"><a href="#cb14-378"></a>The SEM approach gets around this specific criticism of the LDV by explicitly accounting for time-invariant unobserved heterogeneity. This blocks both back-door paths, across (certain) time-varying confounders and time-invariant ones. Thus, the wide use of cross-lagged and other panel models in SEM that account for LDVs is arguably justified.</span>
<span id="cb14-379"><a href="#cb14-379"></a></span>
<span id="cb14-380"><a href="#cb14-380"></a>LDVs are not a silver bullet, however. The researcher's qualitative hypotheses must hold, as always. The LDV will stop confounding if the simplified DAG in Figure \ref{fig-ldv-3} (or something equivalent, such as Figure \ref{fig-ldv-4}) is the true DGP. If the unobserved time-varying confounders affect the current outcome over and above the mediated path over the lagged version, then another unblocked path is opened up. And other assumptions, like the appropriateness of a linear model, must be scrutinized in SEM just as in any other methodology <span class="co">[</span><span class="ot">@bollen2013</span><span class="co">]</span>.</span>
<span id="cb14-381"><a href="#cb14-381"></a></span>
<span id="cb14-382"><a href="#cb14-382"></a>Finally, we did not look at other potential approaches to LDVs, such as the Arellano-Bond (AB) differenced model (which is perhaps the most promising approach outside of SEM), which tries to use lags even further back from the current outcome as instruments <span class="co">[</span><span class="ot">@bruederl2014</span><span class="co">]</span>. In a series of simulations, @leszczensky2019b showed that AB and SEM both performed well under a wide variety of underlying DGPs and assumptions.</span>
<span id="cb14-383"><a href="#cb14-383"></a></span>
<span id="cb14-384"><a href="#cb14-384"></a>Instead, this paper chose to draw attention to an apparently overlooked aspect. At this very moment, a researcher at a sociological conference is likely being alerted to the fact that the LDV is a collider and that their SEM and its results are biased. We believe this should not be a blanket criticism, and that SEM provides a flexible framework for modeling various dynamic processes that suit researchers' qualitative hypotheses.</span>
<span id="cb14-385"><a href="#cb14-385"></a></span>
<span id="cb14-386"><a href="#cb14-386"></a><span class="fu">## References</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>